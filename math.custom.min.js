'use strict';this.math=function(m){function e(k){if(a[k])return a[k].exports;var f=a[k]={exports:{},id:k,loaded:!1};m[k].call(f.exports,f,f.exports,e);f.loaded=!0;return f.exports}var a={};e.m=m;e.c=a;e.p="";return e(0)}([function(m,e,a){e=a(1).create();e.import(a(13));e.import(a(23));e.import(a(24));e.import(a(34));e.import(a(35));e.import(a(36));e.import(a(63));e.import(a(53));e.import(a(67));e.import(a(69));e.import(a(70));m.exports=e},function(m,e,a){m.exports=a(2)},function(m,e,a){var k=a(3).isFactory,
f=a(3).deepExtend,d=a(4),b=a(8),c=a(10),h=a(12);e.create=function(a){function r(b){if(!k(b))throw Error("Factory object with properties `type`, `name`, and `factory` expected");var h=q.indexOf(b);-1===h?(h=!0===b.math?b.factory(e.type,n,r,e.typed,e):b.factory(e.type,n,r,e.typed),q.push(b),g.push(h)):h=g[h];return h}if("function"!==typeof Object.create)throw Error("ES5 not supported by this JavaScript engine. Please load the es5-shim and es5-sham library for compatibility.");var q=[],g=[],e=b.mixin({});
e.type={};e.expression={transform:Object.create(e)};e.typed=d.create(e.type);var n={epsilon:1E-14,matrix:"matrix",number:"number",precision:64,predictable:!1};a&&f(n,a);e["import"]=r(c);e.config=r(h);return e}},function(m,e){e.clone=function k(f){var d=typeof f;if("number"===d||"string"===d||"boolean"===d||null===f||void 0===f)return f;if("function"===typeof f.clone)return f.clone();if(Array.isArray(f))return f.map(function(b){return k(b)});if(f instanceof Number)return new Number(f.valueOf());if(f instanceof
String)return new String(f.valueOf());if(f instanceof Boolean)return new Boolean(f.valueOf());if(f instanceof Date)return new Date(f.valueOf());if(f&&!0===f.isBigNumber)return f;if(f instanceof RegExp)throw new TypeError("Cannot clone "+f);var d={},b;for(b in f)f.hasOwnProperty(b)&&(d[b]=k(f[b]));return d};e.extend=function(e,f){for(var d in f)f.hasOwnProperty(d)&&(e[d]=f[d]);return e};e.deepExtend=function f(d,b){if(Array.isArray(b))throw new TypeError("Arrays are not supported by deepExtend");for(var c in b)if(b.hasOwnProperty(c))if(b[c]&&
b[c].constructor===Object)void 0===d[c]&&(d[c]={}),d[c].constructor===Object?f(d[c],b[c]):d[c]=b[c];else{if(Array.isArray(b[c]))throw new TypeError("Arrays are not supported by deepExtend");d[c]=b[c]}return d};e.deepEqual=function(f,d){var b,c;if(Array.isArray(f)){if(!Array.isArray(d)||f.length!=d.length)return!1;b=0;for(c=f.length;b<c;b++)if(!e.deepEqual(f[b],d[b]))return!1;return!0}if(f instanceof Object){if(Array.isArray(d)||!(d instanceof Object))return!1;for(b in f)if(!e.deepEqual(f[b],d[b]))return!1;
for(b in d)if(!e.deepEqual(f[b],d[b]))return!1;return!0}return typeof f===typeof d&&f==d};e.canDefineProperty=function(){try{if(Object.defineProperty)return Object.defineProperty({},"x",{}),!0}catch(f){}return!1};e.lazy=function(f,d,b){if(e.canDefineProperty()){var c=!0,h;Object.defineProperty(f,d,{get:function(){c&&(h=b(),c=!1);return h},set:function(b){h=b;c=!1},configurable:!0,enumerable:!0})}else f[d]=b()};e.traverse=function(f,d){var b=f;if(d)for(var c=d.split("."),h=0;h<c.length;h++){var e=
c[h];e in b||(b[e]={});b=b[e]}return b};e.isFactory=function(f){return f&&"function"===typeof f.factory}},function(m,e,a){var k=a(5),f=a(6).digits,d=function(){d=k.create;return k};e.create=function(b){var a=d();a.types=[{name:"number",test:function(b){return"number"===typeof b}},{name:"Complex",test:function(b){return b&&b.isComplex}},{name:"BigNumber",test:function(b){return b&&b.isBigNumber}},{name:"Fraction",test:function(b){return b&&b.isFraction}},{name:"Unit",test:function(b){return b&&b.isUnit}},
{name:"string",test:function(b){return"string"===typeof b}},{name:"Array",test:Array.isArray},{name:"Matrix",test:function(b){return b&&b.isMatrix}},{name:"DenseMatrix",test:function(b){return b&&b.isDenseMatrix}},{name:"SparseMatrix",test:function(b){return b&&b.isSparseMatrix}},{name:"ImmutableDenseMatrix",test:function(b){return b&&b.isImmutableDenseMatrix}},{name:"Range",test:function(b){return b&&b.isRange}},{name:"Index",test:function(b){return b&&b.isIndex}},{name:"boolean",test:function(b){return"boolean"===
typeof b}},{name:"ResultSet",test:function(b){return b&&b.isResultSet}},{name:"Help",test:function(b){return b&&b.isHelp}},{name:"function",test:function(b){return"function"===typeof b}},{name:"Date",test:function(b){return b instanceof Date}},{name:"RegExp",test:function(b){return b instanceof RegExp}},{name:"Object",test:function(b){return"object"===typeof b}},{name:"null",test:function(b){return null===b}},{name:"undefined",test:function(b){return void 0===b}}];a.conversions=[{from:"number",to:"BigNumber",
convert:function(a){if(15<f(a))throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+a+"). Use function bignumber(x) to convert to BigNumber.");return new b.BigNumber(a)}},{from:"number",to:"Complex",convert:function(a){return new b.Complex(a,0)}},{from:"number",to:"string",convert:function(b){return b+""}},{from:"BigNumber",to:"Complex",convert:function(a){return new b.Complex(a.toNumber(),0)}},{from:"number",to:"Fraction",convert:function(a){if(15<
f(a))throw new TypeError("Cannot implicitly convert a number with >15 significant digits to Fraction (value: "+a+"). Use function fraction(x) to convert to Fraction.");return new b.Fraction(a)}},{from:"string",to:"number",convert:function(b){var a=Number(b);if(isNaN(a))throw Error('Cannot convert "'+b+'" to a number');return a}},{from:"boolean",to:"number",convert:function(b){return+b}},{from:"boolean",to:"BigNumber",convert:function(a){return new b.BigNumber(+a)}},{from:"boolean",to:"string",convert:function(b){return+b}},
{from:"null",to:"number",convert:function(){return 0}},{from:"null",to:"string",convert:function(){return"null"}},{from:"null",to:"BigNumber",convert:function(){return new b.BigNumber(0)}},{from:"Array",to:"Matrix",convert:function(a){return new b.DenseMatrix(a)}},{from:"Matrix",to:"Array",convert:function(b){return b.valueOf()}}];return a}},function(m,e,a){var k,f,d;"use strict";(function(b){!(f=[],k=b,d="function"===typeof k?k.apply(e,f):k,void 0!==d&&(m.exports=d))})(function(){function b(){function a(b){for(var A,
g=0;g<v.types.length;g++){var c=v.types[g];if(c.name===b){A=c.test;break}}if(!A){for(var f,g=0;g<v.types.length;g++)if(c=v.types[g],c.name.toLowerCase()==b.toLowerCase()){f=c.name;break}throw Error('Unknown type "'+b+'"'+(f?'. Did you mean "'+f+'"?':""));}return A}function f(b){for(var a="",g=0;g<b.length;g++){var c=b[g];if(""!=c.name)if(""==a)a=c.name;else if(a!=c.name)throw b=Error("Function names do not match (expected: "+a+", actual: "+c.name+")"),b.data={actual:c.name,expected:a},b;}return a}
function d(b,a,g,c,f){var l=p(c);f=f?f.split(","):null;var h=b||"unnamed",q=f&&-1!==f.indexOf("any");b={fn:b,index:g,actual:c,expected:f};a=f?a>g&&!q?"Unexpected type of argument in function "+h+" (expected: "+f.join(" or ")+", actual: "+l+", index: "+g+")":"Too few arguments in function "+h+" (expected: "+f.join(" or ")+", index: "+g+")":"Too many arguments in function "+h+" (expected: "+g+", actual: "+a+")";a=new TypeError(a);a.data=b;return a}function e(b){this.name=b||"refs";this.categories={}}
function q(b,a){if("string"===typeof b){var g=b.trim(),c="..."===g.substr(0,3);c&&(g=g.substr(3));if(""===g)this.types=["any"];else for(this.types=g.split("|"),g=0;g<this.types.length;g++)this.types[g]=this.types[g].trim()}else if(Array.isArray(b))this.types=b;else{if(b instanceof q)return b.clone();throw Error("String or Array expected");}this.conversions=[];this.varArgs=c||a||!1;this.anyType=-1!==this.types.indexOf("any")}function g(b,a){var g;if("string"===typeof b)g=""!==b?b.split(","):[];else if(Array.isArray(b))g=
b;else throw Error("string or Array expected");this.params=Array(g.length);for(var c=0;c<g.length;c++){var f=new q(g[c]);this.params[c]=f;if(c===g.length-1)this.varArgs=f.varArgs;else if(f.varArgs)throw new SyntaxError('Unexpected variable arguments operator "..."');}this.fn=a}function k(b,a,g){this.path=b||[];this.param=b[b.length-1]||null;this.signature=a||null;this.childs=g||[]}function n(b){var a,c={},f=[],d,l;for(l in b)if(b.hasOwnProperty(l)&&(a=new g(l,b[l]),!a.ignore()))for(a=a.expand(),d=
0;d<a.length;d++){var h=a[d],q=h.toString(),n=c[q];if(n)if(n=g.compare(h,n),0>n)c[q]=h;else{if(0===n)throw Error('Signature "'+q+'" is defined twice');}else c[q]=h}for(q in c)c.hasOwnProperty(q)&&f.push(c[q]);f.sort(function(b,a){return g.compare(b,a)});for(d=0;d<f.length;d++)if(a=f[d],a.varArgs)for(b=a.params.length-1,c=a.params[b],l=0;l<c.types.length;){if(c.conversions[l])for(q=c.types[l],h=0;h<f.length;h++){var n=f[h],e=n.params[b];if(n!==a&&e&&-1!==e.types.indexOf(q)&&!e.conversions[b]){c.types.splice(l,
1);c.conversions.splice(l,1);l--;break}}l++}return f}function t(b,a){var g,c,f=a.length,d,l=[];for(g=0;g<b.length;g++)c=b[g],c.params.length!==f||d||(d=c),void 0!=c.params[f]&&l.push(c);l.sort(function(b,a){return q.compare(b.params[f],a.params[f])});var h=[];for(g=0;g<l.length;g++){c=l[g];var n=c.params[f],e=h.filter(function(b){return b.param.overlapping(n)})[0];if(e){if(e.param.varArgs)throw Error('Conflicting types "'+e.param+'" and "'+n+'"');e.signatures.push(c)}else h.push({param:n,signatures:[c]})}c=
Array(h.length);for(g=0;g<h.length;g++)l=h[g],c[g]=t(l.signatures,a.concat(l.param));return new k(a,d,c)}function l(b,a){var g=new e,c=n(a);if(0==c.length)throw Error("No signatures provided");for(var f=t(c,[]),l=[],h=b||"",q=0,p=0;p<c.length;p++){var k=c[p].params.length;k>q&&(q=k)}p=[];for(k=0;k<q;k++)p[k]="arg"+k;l.push("function "+h+"("+p.join(", ")+") {");l.push('  "use strict";');l.push("  var name = '"+h+"';");l.push(f.toCode(g,"  "));l.push("}");f=[g.toCode(),"return "+l.join("\n")].join("\n");
g=(new Function(g.name,"createError",f))(g,d);f={};for(l=0;l<c.length;l++)h=c[l],h.fn&&!h.hasConversions()&&(q=h.params.join(","),f[q]=h.fn);g.signatures=f;return g}function p(b){for(var a,g=0;g<v.types.length;g++){var c=v.types[g];if("Object"===c.name)a=c;else if(c.test(b))return c.name}return a&&a.test(b)?a.name:"unknown"}e.prototype.add=function(b,a){var g=a||"fn";this.categories[g]||(this.categories[g]=[]);var c=this.categories[g].indexOf(b);-1==c&&(c=this.categories[g].length,this.categories[g].push(b));
return g+c};e.prototype.toCode=function(){var b=[],a=this.name+".categories",g=this.categories,c;for(c in g)if(g.hasOwnProperty(c))for(var f=g[c],d=0;d<f.length;d++)b.push("var "+c+d+" = "+a+"['"+c+"']["+d+"];");return b.join("\n")};q.compare=function(b,a){if(b.anyType)return 1;if(a.anyType)return-1;if(-1!==b.types.indexOf("Object"))return 1;if(-1!==a.types.indexOf("Object"))return-1;if(b.hasConversions()){if(a.hasConversions()){var g,c,f;for(g=0;g<b.conversions.length;g++)if(void 0!==b.conversions[g]){c=
b.conversions[g];break}for(g=0;g<a.conversions.length;g++)if(void 0!==a.conversions[g]){f=a.conversions[g];break}return v.conversions.indexOf(c)-v.conversions.indexOf(f)}return 1}if(a.hasConversions())return-1;var d,l;for(g=0;g<v.types.length;g++)if(v.types[g].name===b.types[0]){d=g;break}for(g=0;g<v.types.length;g++)if(v.types[g].name===a.types[0]){l=g;break}return d-l};q.prototype.overlapping=function(b){for(var a=0;a<this.types.length;a++)if(-1!==b.types.indexOf(this.types[a]))return!0;return!1};
q.prototype.clone=function(){var b=new q(this.types.slice(),this.varArgs);b.conversions=this.conversions.slice();return b};q.prototype.hasConversions=function(){return 0<this.conversions.length};q.prototype.contains=function(b){for(var a=0;a<this.types.length;a++)if(b[this.types[a]])return!0;return!1};q.prototype.toString=function(b){for(var a=[],g={},c=0;c<this.types.length;c++){var f=this.conversions[c],f=b&&f?f.to:this.types[c];f in g||(g[f]=!0,a.push(f))}return(this.varArgs?"...":"")+a.join("|")};
g.prototype.clone=function(){return new g(this.params.slice(),this.fn)};g.prototype.expand=function(){function b(c,f){if(f.length<c.params.length){var d,l,h,n=c.params[f.length];if(n.varArgs){l=n.clone();for(d=0;d<v.conversions.length;d++)if(h=v.conversions[d],-1===n.types.indexOf(h.from)&&-1!==n.types.indexOf(h.to)){var e=l.types.length;l.types[e]=h.from;l.conversions[e]=h}b(c,f.concat(l))}else{for(d=0;d<n.types.length;d++)b(c,f.concat(new q(n.types[d])));for(d=0;d<v.conversions.length;d++)h=v.conversions[d],
-1===n.types.indexOf(h.from)&&-1!==n.types.indexOf(h.to)&&(l=new q(h.from),l.conversions[0]=h,b(c,f.concat(l)))}}else a.push(new g(f,c.fn))}var a=[];b(this,[]);return a};g.compare=function(b,a){if(b.params.length>a.params.length)return 1;if(b.params.length<a.params.length)return-1;var g,c=b.params.length,f=0,d=0;for(g=0;g<c;g++)b.params[g].hasConversions()&&f++,a.params[g].hasConversions()&&d++;if(f>d)return 1;if(f<d)return-1;for(g=0;g<b.params.length;g++)if(c=q.compare(b.params[g],a.params[g]),0!==
c)return c;return 0};g.prototype.hasConversions=function(){for(var b=0;b<this.params.length;b++)if(this.params[b].hasConversions())return!0;return!1};g.prototype.ignore=function(){for(var b={},a=0;a<v.ignore.length;a++)b[v.ignore[a]]=!0;for(a=0;a<this.params.length;a++)if(this.params[a].contains(b))return!0;return!1};g.prototype.toCode=function(b,a){for(var g=Array(this.params.length),c=0;c<this.params.length;c++){var f=this.params[c],d=f.conversions[0];g[c]=f.varArgs?"varArgs":d?b.add(d.convert,
"convert")+"(arg"+c+")":"arg"+c}return(c=this.fn?b.add(this.fn,"signature"):void 0)?a+"return "+c+"("+g.join(", ")+"); // signature: "+this.params.join(", "):""};g.prototype.toString=function(){return this.params.join(", ")};k.prototype.toCode=function(b,g,f){var d=[];if(this.param){var l=this.path.length-1,h=this.param.conversions[0],h="// type: "+(h?h.from+" (convert to "+h.to+")":this.param);if(this.param.varArgs){if(this.param.anyType)d.push(g+"if (arguments.length > "+l+") {"),d.push(g+"  var varArgs = [];"),
d.push(g+"  for (var i = "+l+"; i < arguments.length; i++) {"),d.push(g+"    varArgs.push(arguments[i]);");else{var n=function(g,f){for(var d=[],l=0;l<g.length;l++)d[l]=b.add(a(g[l]),"test")+"("+f+")";return d.join(" || ")}.bind(this);f=this.param.types;for(var q=[],e=0;e<f.length;e++)void 0===this.param.conversions[e]&&q.push(f[e]);d.push(g+"if ("+n(f,"arg"+l)+") { "+h);d.push(g+"  var varArgs = [arg"+l+"];");d.push(g+"  for (var i = "+(l+1)+"; i < arguments.length; i++) {");d.push(g+"    if ("+
n(q,"arguments[i]")+") {");d.push(g+"      varArgs.push(arguments[i]);");for(e=0;e<f.length;e++)if(l=this.param.conversions[e])n=b.add(a(f[e]),"test"),l=b.add(l.convert,"convert"),d.push(g+"    }"),d.push(g+"    else if ("+n+"(arguments[i])) {"),d.push(g+"      varArgs.push("+l+"(arguments[i]));");d.push(g+"    } else {");d.push(g+"      throw createError(name, arguments.length, i, arguments[i], '"+q.join(",")+"');");d.push(g+"    }")}d.push(g+"  }");d.push(this.signature.toCode(b,g+"  "));d.push(g+
"}")}else this.param.anyType?(d.push(g+"// type: any"),d.push(this._innerCode(b,g,f))):(q=this.param.types[0],n="any"!==q?b.add(a(q),"test"):null,d.push(g+"if ("+n+"(arg"+l+")) { "+h),d.push(this._innerCode(b,g+"  ",f)),d.push(g+"}"))}else d.push(this._innerCode(b,g,f));return d.join("\n")};k.prototype._innerCode=function(b,g,a){var c=[],f;this.signature&&(c.push(g+"if (arguments.length === "+this.path.length+") {"),c.push(this.signature.toCode(b,g+"  ")),c.push(g+"}"));var d;for(f=0;f<this.childs.length;f++)if(this.childs[f].param.anyType){d=
this.childs[f];break}for(f=0;f<this.childs.length;f++)c.push(this.childs[f].toCode(b,g,d));a&&!this.param.anyType&&c.push(a.toCode(b,g,d));(b=this._exceptions(b,g))&&c.push(b);return c.join("\n")};k.prototype._exceptions=function(b,g){var a=this.path.length;if(0===this.childs.length)return[g+"if (arguments.length > "+a+") {",g+"  throw createError(name, arguments.length, "+a+", arguments["+a+"]);",g+"}"].join("\n");for(var c={},f=[],d=0;d<this.childs.length;d++){var l=this.childs[d];if(l.param)for(var h=
0;h<l.param.types.length;h++){var n=l.param.types[h];n in c||l.param.conversions[h]||(c[n]=!0,f.push(n))}}return g+"throw createError(name, arguments.length, "+a+", arguments["+a+"], '"+f.join(",")+"');"};var x=[{name:"number",test:function(b){return"number"===typeof b}},{name:"string",test:function(b){return"string"===typeof b}},{name:"boolean",test:function(b){return"boolean"===typeof b}},{name:"Function",test:function(b){return"function"===typeof b}},{name:"Array",test:Array.isArray},{name:"Date",
test:function(b){return b instanceof Date}},{name:"RegExp",test:function(b){return b instanceof RegExp}},{name:"Object",test:function(b){return"object"===typeof b}},{name:"null",test:function(b){return null===b}},{name:"undefined",test:function(b){return void 0===b}}],u={},w=[],y=[],v={config:u,types:x,conversions:w,ignore:y},v=l("typed",{Object:function(b){var g=[],a;for(a in b)b.hasOwnProperty(a)&&g.push(b[a]);g=f(g);return l(g,b)},"string, Object":l,"...Function":function(b){for(var g=f(b),a={},
c=0;c<b.length;c++){var d=b[c];if("object"!==typeof d.signatures)throw b=new TypeError("Function is no typed-function (index: "+c+")"),b.data={index:c},b;for(var n in d.signatures)if(d.signatures.hasOwnProperty(n))if(a.hasOwnProperty(n)){if(d.signatures[n]!==a[n])throw b=Error('Signature "'+n+'" is defined twice'),b.data={signature:n},b;}else a[n]=d.signatures[n]}return l(g,a)}});v.config=u;v.types=x;v.conversions=w;v.ignore=y;v.create=b;v.find=function(b,g){if(!b.signatures)throw new TypeError("Function is no typed-function");
var a;if("string"===typeof g){a=g.split(",");for(var c=0;c<a.length;c++)a[c]=a[c].trim()}else if(Array.isArray(g))a=g;else throw new TypeError("String array or a comma separated string expected");c=a.join(",");if(c=b.signatures[c])return c;throw new TypeError("Signature not found (signature: "+(b.name||"unnamed")+"("+a.join(", ")+"))");};v.convert=function(b,g){var a=p(b);if(g===a)return b;for(var c=0;c<v.conversions.length;c++){var f=v.conversions[c];if(f.from===a&&f.to===g)return f.convert(b)}throw Error("Cannot convert from "+
a+" to "+g);};v.addType=function(b){if(!b||"string"!==typeof b.name||"function"!==typeof b.test)throw new TypeError("Object with properties {name: string, test: function} expected");v.types.push(b)};v.addConversion=function(b){if(!b||"string"!==typeof b.from||"string"!==typeof b.to||"function"!==typeof b.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");v.conversions.push(b)};return v}return b()})},function(m,e,a){var k=a(7);e.isNumber=function(a){return"number"===
typeof a};e.isInteger=function(a){return isFinite(a)?a==Math.round(a):!1};e.sign=function(a){return 0<a?1:0>a?-1:0};e.format=function(a,d){if("function"===typeof d)return d(a);if(Infinity===a)return"Infinity";if(-Infinity===a)return"-Infinity";if(isNaN(a))return"NaN";var b="auto",c=void 0;d&&(d.notation&&(b=d.notation),e.isNumber(d)?c=d:d.precision&&(c=d.precision));switch(b){case "fixed":return e.toFixed(a,c);case "exponential":return e.toExponential(a,c);case "auto":return e.toPrecision(a,c,d&&
d.exponential).replace(/((\.\d*?)(0+))($|e)/,function(b,a,c,d,g){return"."!==c?c+g:g});default:throw Error('Unknown notation "'+b+'". Choose "auto", "exponential", or "fixed".');}};e.toExponential=function(a,d){return(new k(a)).toExponential(d)};e.toFixed=function(a,d){return(new k(a)).toFixed(d)};e.toPrecision=function(a,d,b){return(new k(a)).toPrecision(d,b)};e.digits=function(a){return a.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length};e.DBL_EPSILON=Number.EPSILON||2.220446049250313E-16;
e.nearlyEqual=function(a,d,b){if(null==b)return a==d;if(a==d)return!0;if(isNaN(a)||isNaN(d))return!1;if(isFinite(a)&&isFinite(d)){var c=Math.abs(a-d);return c<e.DBL_EPSILON?!0:c<=Math.max(Math.abs(a),Math.abs(d))*b}return!1}},function(m,e){function a(a){var d=String(a).toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!d)throw new SyntaxError("Invalid number");a=d[1];var b=d[2],c=parseFloat(d[4]||"0"),d=b.indexOf("."),c=c+(-1!==d?d-1:b.length-1);this.sign=a;this.coefficients=b.replace(".",
"").replace(/^0*/,function(b){c-=b.length;return""}).replace(/0*$/,"").split("").map(function(b){return parseInt(b)});0===this.coefficients.length&&(this.coefficients.push(0),c++);this.exponent=c}function k(a){for(var d=[],b=0;b<a;b++)d.push(0);return d}a.prototype.toFixed=function(a){var d=this.roundDigits(this.exponent+1+(a||0)),b=d.coefficients,d=d.exponent+1,c=d+(a||0);b.length<c&&(b=b.concat(k(c-b.length)));0>d&&(b=k(-d+1).concat(b),d=1);a&&b.splice(d,0,0===d?"0.":".");return this.sign+b.join("")};
a.prototype.toExponential=function(a){var d=a?this.roundDigits(a):this.clone(),b=d.coefficients,d=d.exponent;b.length<a&&(b=b.concat(k(a-b.length)));a=b.shift();return this.sign+a+(0<b.length?"."+b.join(""):"")+"e"+(0<=d?"+":"")+d};a.prototype.toPrecision=function(a,d){var b=d&&void 0!==d.lower?d.lower:.001,c=d&&void 0!==d.upper?d.upper:1E5,h=Math.abs(Math.pow(10,this.exponent));if(h<b||h>=c)return this.toExponential(a);c=a?this.roundDigits(a):this.clone();b=c.coefficients;c=c.exponent;b.length<a&&
(b=b.concat(k(a-b.length)));b=b.concat(k(c-b.length+1+(b.length<a?a-b.length:0)));b=k(-c).concat(b);c=0<c?c:0;c<b.length-1&&b.splice(c+1,0,".");return this.sign+b.join("")};a.prototype.clone=function(){var f=new a("0");f.sign=this.sign;f.coefficients=this.coefficients.slice(0);f.exponent=this.exponent;return f};a.prototype.roundDigits=function(a){for(var d=this.clone(),b=d.coefficients;0>=a;)b.unshift(0),d.exponent++,a++;if(b.length>a&&5<=b.splice(a)[0])for(a-=1,b[a]++;10===b[a];)b.pop(),0===a&&(b.unshift(0),
d.exponent++,a++),a--,b[a]++;return d};m.exports=a},function(m,e,a){var k=a(9);e.mixin=function(a){var d=new k;a.on=d.on.bind(d);a.off=d.off.bind(d);a.once=d.once.bind(d);a.emit=d.emit.bind(d);return a}},function(m,e){function a(){}a.prototype={on:function(a,f,d){var b=this.e||(this.e={});(b[a]||(b[a]=[])).push({fn:f,ctx:d});return this},once:function(a,f,d){var b=this,c=function(){b.off(a,c);f.apply(d,arguments)};return this.on(a,c,d)},emit:function(a){var f=[].slice.call(arguments,1),d=((this.e||
(this.e={}))[a]||[]).slice(),b=0,c=d.length;for(b;b<c;b++)d[b].fn.apply(d[b].ctx,f);return this},off:function(a,f){var d=this.e||(this.e={}),b=d[a],c=[];if(b&&f)for(var h=0,e=b.length;h<e;h++)b[h].fn!==f&&c.push(b[h]);c.length?d[a]=c:delete d[a];return this}};m.exports=a},function(m,e,a){var k=a(3).lazy,f=a(3).isFactory,d=a(3).traverse,b=a(3).extend,c=a(11);e.math=!0;e.name="import";e.factory=function(a,e,r,q,g){function z(b,a){var g=arguments.length;if(1!=g&&2!=g)throw new c("import",g,1,2);a||(a=
{});if(f(b))p(b,a);else if(Array.isArray(b))b.forEach(function(b){z(b,a)});else if("object"===typeof b)for(var d in b)b.hasOwnProperty(d)&&(g=b[d],"function"==typeof g||"number"===typeof g||"string"===typeof g||"boolean"===typeof g||null===g||g&&!0===g.isUnit||g&&!0===g.isComplex?n(d,g,a):f(b)?p(b,a):z(g,a));else if(!a.silent)throw new TypeError("Factory, Object, or Array expected");}function n(a,c,d){d.wrap&&"function"===typeof c&&(c=l(c));if(x(g[a])&&x(c))c=d.override?q(b({},g[a].signatures,c.signatures)):
q(g[a],c),g[a]=c,t(a,c),g.emit("import",a,function(){return c});else if(void 0===g[a]||d.override)g[a]=c,t(a,c),g.emit("import",a,function(){return c});else if(!d.silent)throw Error('Cannot import "'+a+'": already exists');}function t(b,a){a&&"function"===typeof a.transform&&(g.expression.transform[b]=a.transform)}function l(b){var a=function(){for(var a=[],c=0,d=arguments.length;c<d;c++){var l=arguments[c];a[c]=l&&l.valueOf()}return b.apply(g,a)};b.transform&&(a.transform=b.transform);return a}function p(a,
c){if("string"===typeof a.name){var l=a.name,f=a.path?d(g,a.path):g,h=f.hasOwnProperty(l)?f[l]:void 0,n=function(){var g=r(a);if(x(h)&&x(g))return g=c.override?q(b({},h.signatures,g.signatures)):q(h,g);if(void 0===h||c.override)return g;if(!c.silent)throw Error('Cannot import "'+l+'": already exists');};!1!==a.lazy?k(f,l,n):f[l]=n();g.emit("import",l,n,a.path)}else r(a)}function x(b){return"function"===typeof b&&"object"===typeof b.signatures}return z};e.lazy=!0},function(m,e){function a(e,f,d,b){if(!(this instanceof
a))throw new SyntaxError("Constructor must be called with the new operator");this.fn=e;this.count=f;this.min=d;this.max=b;this.message="Wrong number of arguments in function "+e+" ("+f+" provided, "+d+(void 0!=b?"-"+b:"")+" expected)";this.stack=Error().stack}a.prototype=Error();a.prototype.constructor=Error;a.prototype.name="ArgumentsError";a.prototype.isArgumentsError=!0;m.exports=a},function(m,e,a){var k=a(3);e.name="config";e.math=!0;e.factory=function(a,d,b,c,h){return function(b){if(b){var a=
k.clone(d);k.deepExtend(d,b);b=k.clone(d);h.emit("config",b,a);return b}return k.clone(d)}}},function(m,e,a){var k=a(14).string.isString;e.name="Matrix";e.path="type";e.factory=function(a,d,b,c){function h(){if(!(this instanceof h))throw new SyntaxError("Constructor must be called with the new operator");}h.prototype.type="Matrix";h.prototype.isMatrix=!0;h.storage=function(b){if(!k(b))throw new TypeError("format must be a string value");var a=h._storage[b];if(!a)throw new SyntaxError("Unsupported matrix storage format: "+
b);return a};h._storage={};h.prototype.storage=function(){throw Error("Cannot invoke storage on a Matrix interface");};h.prototype.datatype=function(){throw Error("Cannot invoke datatype on a Matrix interface");};h.prototype.create=function(b,a){throw Error("Cannot invoke create on a Matrix interface");};h.prototype.subset=function(b,a,c){throw Error("Cannot invoke subset on a Matrix interface");};h.prototype.get=function(b){throw Error("Cannot invoke get on a Matrix interface");};h.prototype.set=
function(b,a,c){throw Error("Cannot invoke set on a Matrix interface");};h.prototype.resize=function(b,a){throw Error("Cannot invoke resize on a Matrix interface");};h.prototype.clone=function(){throw Error("Cannot invoke clone on a Matrix interface");};h.prototype.size=function(){throw Error("Cannot invoke size on a Matrix interface");};h.prototype.map=function(b,a){throw Error("Cannot invoke map on a Matrix interface");};h.prototype.forEach=function(b){throw Error("Cannot invoke forEach on a Matrix interface");
};h.prototype.toArray=function(){throw Error("Cannot invoke toArray on a Matrix interface");};h.prototype.valueOf=function(){throw Error("Cannot invoke valueOf on a Matrix interface");};h.prototype.format=function(b){throw Error("Cannot invoke format on a Matrix interface");};h.prototype.toString=function(){throw Error("Cannot invoke toString on a Matrix interface");};return h}},function(m,e,a){e.array=a(15);e["boolean"]=a(21);e["function"]=a(22);e.number=a(6);e.object=a(3);e.string=a(16);e.types=
a(18);e.emitter=a(8)},function(m,e,a){function k(b,a,c){var d=b.length;if(d!=a[c])throw new r(d,a[c]);if(c<a.length-1){var l=c+1;for(c=0;c<d;c++){if(!Array.isArray(b[c]))throw new r(a.length-1,a.length,"<");k(b[c],a,l)}}else for(c=0;c<d;c++)if(Array.isArray(b[c]))throw new r(a.length+1,a.length,">");}function f(b,a,c,d){var l,h=a[c],q=Math.min(b.length,h);b.length=h;if(c<a.length-1){var r=c+1;for(c=0;c<q;c++)l=b[c],Array.isArray(l)||(l=[l],b[c]=l),f(l,a,r,d);for(c=q;c<h;c++)l=[],b[c]=l,f(l,a,r,d)}else{for(c=
0;c<q;c++)for(;Array.isArray(b[c]);)b[c]=b[c][0];if(d!==e.UNINITIALIZED)for(c=q;c<h;c++)b[c]=s.clone(d)}}function d(b,a,c){var f;if(c<a){var l=c+1;c=0;for(f=b.length;c<f;c++)b[c]=d(b[c],a,l)}else for(;Array.isArray(b);)b=b[0];return b}function b(a,c,d){var f;if(Array.isArray(a)){var l=d+1;d=0;for(f=a.length;d<f;d++)a[d]=b(a[d],c,l)}else for(;d<c;d++)a=[a];return a}var c=a(6),h=a(16),s=a(3);a(18);var r=a(19),q=a(20);e.size=function(b){for(var a=[];Array.isArray(b);)a.push(b.length),b=b[0];return a};
e.validate=function(b,a){if(0==a.length){if(Array.isArray(b))throw new r(b.length,0);}else k(b,a,0)};e.validateIndex=function(b,a){if(!c.isNumber(b)||!c.isInteger(b))throw new TypeError("Index must be an integer (value: "+b+")");if(0>b)throw new q(b);if(void 0!==a&&b>=a)throw new q(b,a);};e.UNINITIALIZED={};e.resize=function(b,a,d){if(!Array.isArray(b)||!Array.isArray(a))throw new TypeError("Array expected");if(0===a.length)throw Error("Resizing to scalar is not supported");a.forEach(function(b){if(!c.isNumber(b)||
!c.isInteger(b)||0>b)throw new TypeError("Invalid size, must contain positive integers (size: "+h.format(a)+")");});f(b,a,0,void 0!==d?d:0);return b};e.squeeze=function(b,a){for(var c=a||e.size(b);Array.isArray(b)&&1===b.length;)b=b[0],c.shift();for(var f=c.length;1===c[f-1];)f--;f<c.length&&(b=d(b,f,0),c.length=f);return b};e.unsqueeze=function(a,c,d,f){f=f||e.size(a);if(d)for(var l=0;l<d;l++)a=[a],f.unshift(1);for(a=b(a,c,0);f.length<c;)f.push(1);return a};e.flatten=function(b){if(!Array.isArray(b))return b;
var a=[];b.forEach(function t(b){Array.isArray(b)?b.forEach(t):a.push(b)});return a};e.isArray=Array.isArray},function(m,e,a){function k(b,a){if(Array.isArray(b)){for(var d="[",f=b.length,r=0;r<f;r++)0!=r&&(d+=", "),d+=k(b[r],a);return d+"]"}return e.format(b,a)}var f=a(6).format,d=a(17).format;e.isString=function(b){return"string"===typeof b};e.endsWith=function(b,a){return b.substring(b.length-a.length,b.length)===a};e.format=function(b,a){return"number"===typeof b?f(b,a):b&&!0===b.isBigNumber?
d(b,a):b&&!0===b.isFraction?a&&"decimal"===a.fraction?b.toString():b.s*b.n+"/"+b.d:Array.isArray(b)?k(b,a):e.isString(b)?'"'+b+'"':"function"===typeof b?b.syntax?b.syntax+"":"function":"object"===typeof b?"function"===typeof b.format?b.format(a):b.toString():String(b)}},function(m,e){e.format=function(a,k){if("function"===typeof k)return k(a);if(!a.isFinite())return a.isNaN()?"NaN":a.gt(0)?"Infinity":"-Infinity";var f="auto",d=void 0;void 0!==k&&(k.notation&&(f=k.notation),"number"===typeof k?d=k:
k.precision&&(d=k.precision));switch(f){case "fixed":return e.toFixed(a,d);case "exponential":return e.toExponential(a,d);case "auto":var f=.001,b=1E5;k&&k.exponential&&(void 0!==k.exponential.lower&&(f=k.exponential.lower),void 0!==k.exponential.upper&&(b=k.exponential.upper));a.constructor.config({toExpNeg:Math.round(Math.log(f)/Math.LN10),toExpPos:Math.round(Math.log(b)/Math.LN10)});if(a.isZero())return"0";var c=a.abs();return(c.gte(f)&&c.lt(b)?a.toSignificantDigits(d).toFixed():e.toExponential(a,
d)).replace(/((\.\d*?)(0+))($|e)/,function(b,a,c,d,g){return"."!==c?c+g:g});default:throw Error('Unknown notation "'+f+'". Choose "auto", "exponential", or "fixed".');}};e.toExponential=function(a,e){return void 0!==e?a.toExponential(e-1):a.toExponential()};e.toFixed=function(a,e){return a.toFixed(e||0)}},function(m,e){e.type=function(a){var e=typeof a;return"object"===e?null===a?"null":a instanceof Boolean?"boolean":a instanceof Number?"number":a instanceof String?"string":Array.isArray(a)?"Array":
a instanceof Date?"Date":a instanceof RegExp?"RegExp":"Object":"function"===e?"Function":e}},function(m,e){function a(e,f,d){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");this.actual=e;this.expected=f;this.relation=d;this.message="Dimension mismatch ("+(Array.isArray(e)?"["+e.join(", ")+"]":e)+" "+(this.relation||"!=")+" "+(Array.isArray(f)?"["+f.join(", ")+"]":f)+")";this.stack=Error().stack}a.prototype=new RangeError;a.prototype.constructor=RangeError;
a.prototype.name="DimensionError";a.prototype.isDimensionError=!0;m.exports=a},function(m,e){function a(e,f,d){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");this.index=e;3>arguments.length?(this.min=0,this.max=f):(this.min=f,this.max=d);this.message=void 0!==this.min&&this.index<this.min?"Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?"Index out of range ("+this.index+" > "+(this.max-1)+")":"Index out of range ("+
this.index+")";this.stack=Error().stack}a.prototype=new RangeError;a.prototype.constructor=RangeError;a.prototype.name="IndexError";a.prototype.isIndexError=!0;m.exports=a},function(m,e){e.isBoolean=function(a){return"boolean"==typeof a}},function(m,e){e.memoize=function(a,e){return function d(){"object"!==typeof d.cache&&(d.cache={});for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];c=e?e(b):JSON.stringify(b);return c in d.cache?d.cache[c]:d.cache[c]=a.apply(a,b)}}},function(m,e,a){var k=
a(14),f=a(19),d=k.string,b=k.array,c=k.object;m=k.number;var h=Array.isArray,s=m.isNumber,r=m.isInteger,q=d.isString,g=b.validateIndex;e.name="DenseMatrix";e.path="type";e.factory=function(e,n,t,l){function p(a,g){if(!(this instanceof p))throw new SyntaxError("Constructor must be called with the new operator");if(g&&!q(g))throw Error("Invalid datatype: "+g);if(a&&!0===a.isMatrix)"DenseMatrix"===a.type?(this._data=c.clone(a._data),this._size=c.clone(a._size)):(this._data=a.toArray(),this._size=a.size()),
this._datatype=g||a._datatype;else if(a&&h(a.data)&&h(a.size))this._data=a.data,this._size=a.size,this._datatype=g||a.datatype;else{if(h(a))this._data=v(a),this._size=b.size(this._data),b.validate(this._data,this._size);else{if(a)throw new TypeError("Unsupported type of data ("+k.types.type(a)+")");this._data=[];this._size=[0]}this._datatype=g}}function x(b,a,c,g){var d=g==c-1,l=a.dimension(g);return d?l.map(function(a){return b[a]}).valueOf():l.map(function(d){return x(b[d],a,c,g+1)}).valueOf()}
function u(a,g,d,l){if(!g||!0!==g.isIndex)throw new TypeError("Invalid index");var h=g.size(),e=g.isScalar(),q;d&&!0===d.isMatrix?(q=d.size(),d=d.valueOf()):q=b.size(d);if(e){if(0!==q.length)throw new TypeError("Scalar expected");a.set(g.min(),d,l)}else{if(h.length<a._size.length)throw new f(h.length,a._size.length,"<");if(q.length<h.length){for(var p=e=0;1===h[e]&&1===q[e];)e++;for(;1===h[e];)p++,e++;d=b.unsqueeze(d,h.length,p,q)}if(!c.deepEqual(h,q))throw new f(h,q,">");q=g.max().map(function(b){return b+
1});y(a,q,l);w(a._data,g,d,h.length,0)}return a}function w(b,a,c,d,l){var f=l==d-1,h=a.dimension(l);f?h.forEach(function(a,d){g(a);b[a]=c[d[0]]}):h.forEach(function(f,h){g(f);w(b[f],a,c[h[0]],d,l+1)})}function y(b,a,g){for(var d=c.clone(b._size),l=!1;d.length<a.length;)d.push(0),l=!0;for(var f=0,h=a.length;f<h;f++)a[f]>d[f]&&(d[f]=a[f],l=!0);l&&B(b,d,g)}function v(b){for(var a=0,c=b.length;a<c;a++){var g=b[a];h(g)?b[a]=v(g):g&&!0===g.isMatrix&&(b[a]=v(g.valueOf()))}return b}n=t(a(13));p.prototype=
new n;p.prototype.type="DenseMatrix";p.prototype.isDenseMatrix=!0;p.prototype.storage=function(){return"dense"};p.prototype.datatype=function(){return this._datatype};p.prototype.create=function(b,a){return new p(b,a)};p.prototype.subset=function(b,a,c){switch(arguments.length){case 1:var d;if(!b||!0!==b.isIndex)throw new TypeError("Invalid index");if(b.isScalar())d=this.get(b.min());else{d=b.size();if(d.length!=this._size.length)throw new f(d.length,this._size.length);for(var l=b.min(),h=b.max(),
e=0,q=this._size.length;e<q;e++)g(l[e],this._size[e]),g(h[e],this._size[e]);d=new p(x(this._data,b,d.length,0),this._datatype)}return d;case 2:case 3:return u(this,b,a,c);default:throw new SyntaxError("Wrong number of arguments");}};p.prototype.get=function(b){if(!h(b))throw new TypeError("Array expected");if(b.length!=this._size.length)throw new f(b.length,this._size.length);for(var a=0;a<b.length;a++)g(b[a],this._size[a]);for(var a=this._data,d=0,l=b.length;d<l;d++){var e=b[d];g(e,a.length);a=a[e]}return c.clone(a)};
p.prototype.set=function(b,a,c){if(!h(b))throw new TypeError("Array expected");if(b.length<this._size.length)throw new f(b.length,this._size.length,"<");var d,l;d=b.map(function(b){return b+1});y(this,d,c);var e=this._data;c=0;for(d=b.length-1;c<d;c++)l=b[c],g(l,e.length),e=e[l];l=b[b.length-1];g(l,e.length);e[l]=a;return this};p.prototype.resize=function(b,a,c){if(!h(b))throw new TypeError("Array expected");c=c?this.clone():this;return B(c,b,a)};var B=function(a,d,g){if(0===d.length){for(a=a._data;h(a);)a=
a[0];return c.clone(a)}a._size=c.clone(d);a._data=b.resize(a._data,a._size,g);return a};p.prototype.clone=function(){return new p({data:c.clone(this._data),size:c.clone(this._size),datatype:this._datatype})};p.prototype.size=function(){return this._size};p.prototype.map=function(b){var a=this,d=function(c,g){return h(c)?c.map(function(b,a){return d(b,g.concat(a))}):b(c,g,a)};return new p({data:d(this._data,[]),size:c.clone(this._size),datatype:this._datatype})};p.prototype.forEach=function(b){var a=
this,c=function(d,g){h(d)?d.forEach(function(b,a){c(b,g.concat(a))}):b(d,g,a)};c(this._data,[])};p.prototype.toArray=function(){return c.clone(this._data)};p.prototype.valueOf=function(){return this._data};p.prototype.format=function(b){return d.format(this._data,b)};p.prototype.toString=function(){return d.format(this._data)};p.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}};p.prototype.diagonal=function(b){if(b){if(!0===b.isBigNumber&&
(b=b.toNumber()),!s(b)||!r(b))throw new TypeError("The parameter k must be an integer number");}else b=0;var a=0<b?b:0;b=0>b?-b:0;for(var d=Math.min(this._size[0]-b,this._size[1]-a),g=[],l=0;l<d;l++)g[l]=c.clone(this._data[l+b][l+a]);return new p({data:g,size:[d],datatype:this._datatype})};p.diagonal=function(a,c,d,g,f){if(!h(a))throw new TypeError("Array expected, size parameter");if(2!==a.length)throw Error("Only two dimensions matrix are supported");a=a.map(function(b){b&&!0===b.isBigNumber&&(b=
b.toNumber());if(!s(b)||!r(b)||1>b)throw Error("Size values must be positive integers");return b});if(d){if(d&&!0===d.isBigNumber&&(d=d.toNumber()),!s(d)||!r(d))throw new TypeError("The parameter k must be an integer number");}else d=0;g&&q(f)&&(g=l.convert(g,f));f=0<d?d:0;d=0>d?-d:0;var n=a[0],t=a[1],k=Math.min(n-d,t-f),w;if(h(c)){if(c.length!==k)throw Error("Invalid value array length");w=function(b){return c[b]}}else if(c&&!0===c.isMatrix){w=c.size();if(1!==w.length||w[0]!==k)throw Error("Invalid matrix length");
w=function(b){return c.get([b])}}else w=function(){return c};g||(g=w(0)&&!0===w(0).isBigNumber?new e.BigNumber(0):0);var u=[];if(0<a.length)for(u=b.resize(u,a,g),a=0;a<k;a++)u[a+d][a+f]=w(a);return new p({data:u,size:[n,t]})};p.fromJSON=function(b){return new p(b)};p.prototype.swapRows=function(b,a){if(!(s(b)&&r(b)&&s(a)&&r(a)))throw Error("Row index must be positive integers");if(2!==this._size.length)throw Error("Only two dimensional matrix is supported");g(b,this._size[0]);g(a,this._size[0]);p._swapRows(b,
a,this._data);return this};p._swapRows=function(b,a,c){var d=c[b];c[b]=c[a];c[a]=d};e.Matrix._storage.dense=p;return e.Matrix._storage["default"]=p};e.lazy=!1},function(m,e,a){var k=a(25),f=a(26);e.name="sin";e.factory=function(d,b,c,e){var s=e.find(c(a(31)),["number"]),r=e.find(c(a(33)),["number"]),q=e("sin",{number:Math.sin,Complex:function(b){return new d.Complex(Math.sin(b.re)*s(-b.im),Math.cos(b.re)*r(b.im))},BigNumber:function(b){return f(b,d.BigNumber,1,!1)},Unit:function(b){if(!b.hasBase(d.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sin is no angle");
return Math.sin(b.value)},"Array | Matrix":function(b){return k(b,q,!0)}});q.toTex="\\sin\\left(${args[0]}\\right)";return q}},function(m,e){m.exports=function k(f,d,b){return f&&"function"===typeof f.map?f.map(function(c){return k(c,d,b)}):d(f)}},function(m,e,a){var k=a(27),f=a(30);m.exports=function(a,b,c,e){if(a.isNaN()||!a.isFinite())return new b(NaN);var s=b.precision,r=new b(a);if(a=r.isNegative())r.s=-r.s;var q=s+(Math.log(s)|0)+3;b.config({precision:q});r=k(r,b.constructor({precision:q}),
c);r[0].constructor=b;if(r[1])return r=r[0],e&&r.isZero()&&(r=new b(Infinity)),b.config({precision:s}),r;r=r[0];if(c){c=f(r.div(3125),c);b.config({precision:Math.min(q,s+15)});for(var r=new b(5),g=new b(16),z=new b(20),n=0;5>n;++n){var q=c.times(c),t=q.times(c),q=t.times(q);c=g.times(q).minus(z.times(t)).plus(r.times(c))}a&&(c.s=-c.s)}else for(r.abs().lt(b.ONE)?(g=64,a=3):(g=256,a=4),c=f(r.div(g),c),b.config({precision:Math.min(q,s+8)}),r=new b(8);0<a;--a)q=c.times(c),c=q.times(q),c=r.times(c.minus(q)).plus(b.ONE);
e&&(c=c.e<=-s?new b(Infinity):b.ONE.div(c));b.config({precision:s});return c.toDP(s-1)}},function(m,e,a){var k=a(28);m.exports=function(a,d,b){var c=k.pi(d.constructor({precision:d.precision+2})),e=k.tau(d);if(a.abs().lte(c.toDP(a.dp())))return[a,!1];if(0==a.div(c.toDP(a.dp())).toNumber()%2)return[new d(b^1),!0];var s=a.mod(e);if(s.toDP(a.dp(),1).isZero())return[new d(b^1),!0];s.gt(c)&&(b?(s=s.minus(c),s.s=-s.s):s=e.minus(s));s.constructor=a.constructor;return[s,!1]}},function(m,e,a){function k(a){return a[0].precision}
m=a(22).memoize;var f=a(29);e.e=m(function(a){return(new a(1)).exp()},k);e.phi=m(function(a){return(new a(1)).plus((new a(5)).sqrt()).div(2)},k);e.pi=m(function(a){var b=a.constructor({precision:a.precision+4}),b=(new b(4)).times(f((new b(1)).div(5))).minus(f((new b(1)).div(239)));return(new a(4)).times(b)},k);e.tau=m(function(a){var b=e.pi(a.constructor({precision:a.precision+2}));return(new a(2)).times(b)},k)},function(m,e){m.exports=function(a){for(var e=a,f=NaN,d=a.times(a),b=!0,c=3;!e.equals(f);c+=
2)a=a.times(d),f=e,e=(b=!b)?e.plus(a.div(c)):e.minus(a.div(c));return e}},function(m,e){m.exports=function(a,e){for(var f=a.constructor.ONE,d=a,b=NaN,c=a.times(a),h=e?d:d=f,s=!0,r=e;!d.equals(b);r+=2)h=h.times(c),f=f.times(r+1).times(r+2),b=d,d=(s=!s)?d.plus(h.div(f)):d.minus(h.div(f));return d}},function(m,e,a){function k(b){return(Math.exp(b)+Math.exp(-b))/2}var f=a(25),d=a(32);e.name="cosh";e.factory=function(b,a,e,s){var r=s("cosh",{number:k,Complex:function(a){var c=Math.exp(a.re),d=Math.exp(-a.re);
return new b.Complex(Math.cos(a.im)*(c+d)/2,Math.sin(a.im)*(c-d)/2)},BigNumber:function(a){return d(a,b.BigNumber,!1,!1)},Unit:function(a){if(!a.hasBase(b.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cosh is no angle");return k(a.value)},"Array | Matrix":function(b){return f(b,r)}});r.toTex="\\cosh\\left(${args[0]}\\right)";return r}},function(m,e){m.exports=function(a,e,f,d){if(a.isNaN())return new e(NaN);if(!a.isFinite())return d?new e(0):new e(f?a:Infinity);var b=e.precision;e.config({precision:b+
4});a=new e(a);a.constructor=e;a=a.exp();a=f?a.minus(e.ONE.div(a)):a.plus(e.ONE.div(a));a=d?(new e(2)).div(a):a.div(2);e.config({precision:b});return new e(a.toPrecision(b))}},function(m,e,a){function k(b){return 1>Math.abs(b)?b+b*b*b/6+b*b*b*b*b/120:(Math.exp(b)-Math.exp(-b))/2}var f=a(25),d=a(32);e.name="sinh";e.factory=function(b,a,e,s){var r=s("sinh",{number:k,Complex:function(a){var c=Math.cos(a.im),d=Math.sin(a.im),e=Math.exp(a.re);a=Math.exp(-a.re);return new b.Complex(c*(e-a)/2,d*(e+a)/2)},
BigNumber:function(a){return d(a,b.BigNumber,!0,!1)},Unit:function(a){if(!a.hasBase(b.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sinh is no angle");return k(a.value)},"Array | Matrix":function(a){return f(a,r,!0)}});r.toTex="\\sinh\\left(${args[0]}\\right)";return r}},function(m,e,a){var k=a(25),f=a(26);e.name="cos";e.factory=function(d,b,c,e){var s=e.find(c(a(31)),["number"]),r=e.find(c(a(33)),["number"]),q=e("cos",{number:Math.cos,Complex:function(a){return new d.Complex(Math.cos(a.re)*
s(-a.im),Math.sin(a.re)*r(-a.im))},BigNumber:function(a){return f(a,d.BigNumber,0,!1)},Unit:function(a){if(!a.hasBase(d.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cos is no angle");return Math.cos(a.value)},"Array | Matrix":function(a){return k(a,q)}});q.toTex="\\cos\\left(${args[0]}\\right)";return q}},function(m,e,a){var k=a(25);e.name="sqrt";e.factory=function(a,d,b,c){function e(b){return 0<=b||d.predictable?Math.sqrt(b):s(new a.Complex(b,0))}function s(b){var c=Math.sqrt(b.re*
b.re+b.im*b.im),d;d=0<=b.re?.5*Math.sqrt(2*(c+b.re)):Math.abs(b.im)/Math.sqrt(2*(c-b.re));c=0>=b.re?.5*Math.sqrt(2*(c-b.re)):Math.abs(b.im)/Math.sqrt(2*(c+b.re));return 0<=b.im?new a.Complex(d,c):new a.Complex(d,-c)}var r=c("sqrt",{number:e,Complex:s,BigNumber:function(a){return!a.isNegative()||d.predictable?a.sqrt():e(a.toNumber())},"Array | Matrix":function(a){return k(a,r,!0)}});r.toTex="\\sqrt{${args[0]}}";return r}},function(m,e,a){e.name="norm";e.factory=function(e,f,d,b){function c(a,b){var d=
a.size();if(1==d.length){if(b===Number.POSITIVE_INFINITY||"inf"===b){var e=0;a.forEach(function(a){a=h(a);n(a,e)&&(e=a)},!0);return e}if(b===Number.NEGATIVE_INFINITY||"-inf"===b){var l;a.forEach(function(a){a=h(a);if(!l||t(a,l))l=a},!0);return l||0}if("fro"===b)return c(a,2);if("number"===typeof b&&!isNaN(b)){if(!z(b,0)){var f=0;a.forEach(function(a){f=s(r(h(a),b),f)},!0);return r(f,1/b)}return Number.POSITIVE_INFINITY}throw Error("Unsupported parameter value");}if(2==d.length){if(1===b){var k=[],
u=0;a.forEach(function(a,b){var c=b[1],d=s(k[c]||0,h(a));n(d,u)&&(u=d);k[c]=d},!0);return u}if(b===Number.POSITIVE_INFINITY||"inf"===b){var m=[],G=0;a.forEach(function(a,b){var c=b[0],d=s(m[c]||0,h(a));n(d,G)&&(G=d);m[c]=d},!0);return G}if("fro"===b)return q(p(g(x(a),a)));if(2===b)throw Error("Unsupported parameter value, missing implementation of matrix singular value decomposition");throw Error("Unsupported parameter value");}}var h=d(a(37)),s=d(a(38)),r=d(a(48)),q=d(a(35)),g=d(a(53)),z=d(a(44)),
n=d(a(56)),t=d(a(60)),l=d(a(39)),p=d(a(61)),x=d(a(62));e=b.find(h,["Complex"]);var u=b("norm",{number:Math.abs,Complex:e,BigNumber:function(a){return a.abs()},"boolean | null":function(a){return Math.abs(a)},Array:function(a){return c(l(a),2)},Matrix:function(a){return c(a,2)},"number | Complex | BigNumber | boolean | null, number | BigNumber | string":function(a){return u(a)},"Array, number | BigNumber | string":function(a,b){return c(l(a),b)},"Matrix, number | BigNumber | string":function(a,b){return c(a,
b)}});u.toTex={1:"\\left\\|${args[0]}\\right\\|",2:"\\mathrm{${name}}\\left(${args}\\right)"};return u}},function(m,e,a){var k=a(25);e.name="abs";e.factory=function(a,d,b,c){var e=c("abs",{number:Math.abs,Complex:function(a){var b=Math.abs(a.re);a=Math.abs(a.im);if(1E3>b&&1E3>a)return Math.sqrt(b*b+a*a);if(b>=a)return a/=b,b*Math.sqrt(1+a*a);b/=a;return a*Math.sqrt(1+b*b)},BigNumber:function(a){return a.abs()},Fraction:function(a){return a.abs()},"Array | Matrix":function(a){return k(a,e,!0)}});e.toTex=
"\\left|${args[0]}\\right|";return e}},function(m,e,a){var k=a(3).extend;e.name="add";e.factory=function(e,d,b,c){var h=b(a(39)),s=b(a(40));e=a(41);var r=b(a(42)),q=b(a(43)),g=b(a(45)),z=b(a(46)),n=b(a(47)),t=c("add",k({"Matrix, Matrix":function(a,b){var c;switch(a.storage()){case "sparse":switch(b.storage()){case "sparse":c=q(a,b,s);break;default:c=r(b,a,s,!0)}break;default:switch(b.storage()){case "sparse":c=r(a,b,s,!1);break;default:c=z(a,b,s)}}return c},"Array, Array":function(a,b){return t(h(a),
h(b)).valueOf()},"Array, Matrix":function(a,b){return t(h(a),b)},"Matrix, Array":function(a,b){return t(a,h(b))},"Matrix, any":function(a,b){var c;switch(a.storage()){case "sparse":c=g(a,b,s,!1);break;default:c=n(a,b,s,!1)}return c},"any, Matrix":function(a,b){var c;switch(b.storage()){case "sparse":c=g(b,a,s,!0);break;default:c=n(b,a,s,!0)}return c},"Array, any":function(a,b){return n(h(a),b,s,!1).valueOf()},"any, Array":function(a,b){return n(h(b),a,s,!0).valueOf()}},s.signatures));t.toTex="\\left(${args[0]}"+
e.operators.add+"${args[1]}\\right)";return t}},function(m,e){e.name="matrix";e.factory=function(a,e,f,d){function b(b,d,e){return new (a.Matrix.storage(d||"default"))(b,e)}e=d("matrix",{"":function(){return b([])},string:function(a){return b([],a)},"string, string":function(a,d){return b([],a,d)},Array:function(a){return b(a)},Matrix:function(a){return b(a,a.storage())},"Array | Matrix, string":b,"Array | Matrix, string, string":b});e.toTex={0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",
2:"\\left(${args[0]}\\right)"};return e}},function(m,e){e.factory=function(a,e,f,d){return d("add",{"number, number":function(a,c){return a+c},"Complex, Complex":function(b,c){return new a.Complex(b.re+c.re,b.im+c.im)},"BigNumber, BigNumber":function(a,c){return a.plus(c)},"Fraction, Fraction":function(a,c){return a.add(c)},"Unit, Unit":function(a,c){if(null==a.value)throw Error("Parameter x contains a unit with undefined value");if(null==c.value)throw Error("Parameter y contains a unit with undefined value");
if(!a.equalBase(c))throw Error("Units do not match");var d=a.clone();d.value+=c.value;d.fixPrefix=!1;return d}})}},function(m,e){e.symbols={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",
Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega","true":"\\mathrm{True}","false":"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",
oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"};e.operators={transpose:"^\\top",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",
or:"\\vee"};e.defaultTemplate="\\mathrm{${name}}\\left(${args}\\right)";var a={deg:"^\\circ"};e.toSymbol=function(k,f){if("undefined"===typeof f?0:f)return a.hasOwnProperty(k)?a[k]:"\\mathrm{"+k+"}";if(e.symbols.hasOwnProperty(k))return e.symbols[k];if(-1!==k.indexOf("_")){var d=k.indexOf("_");return e.toSymbol(k.substring(0,d))+"_{"+e.toSymbol(k.substring(d+1))+"}"}return k}},function(m,e,a){var k=a(19);e.name="algorithm01";e.factory=function(a,d,b,c){var e=a.DenseMatrix;return function(a,b,d,g){var f=
a._data,n=a._size,t=a._datatype;a=b._values;var l=b._index,p=b._ptr,x=b._size,u=b._datatype;if(n.length!==x.length)throw new k(n.length,x.length);if(n[0]!==x[0]||n[1]!==x[1])throw new RangeError("Dimension mismatch. Matrix A ("+n+") must match Matrix B ("+x+")");if(!a)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");b=n[0];n=n[1];d=(t="string"===typeof t&&t===u?t:void 0)?c.find(d,[t,t]):d;for(var w=[],u=0;u<b;u++)w[u]=[];for(var y=[],v=[],x=0;x<n;x++){for(var m=x+
1,A=p[x+1],E=p[x];E<A;E++)u=l[E],y[u]=g?d(a[E],f[u][x]):d(f[u][x],a[E]),v[u]=m;for(u=0;u<b;u++)w[u][x]=v[u]===m?y[u]:f[u][x]}return new e({data:w,size:[b,n],datatype:t})}}},function(m,e,a){var k=a(19);e.name="algorithm04";e.factory=function(e,d,b,c){var h=b(a(44)),s=e.SparseMatrix;return function(a,b,d){var e=a._values,f=a._index,t=a._ptr,l=a._size,p=a._datatype;a=b._values;var x=b._index,u=b._ptr,w=b._size,y=b._datatype;if(l.length!==w.length)throw new k(l.length,w.length);if(l[0]!==w[0]||l[1]!==
w[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+w+")");var v=l[0],l=l[1],m;b=h;var w=0,A=d;"string"===typeof p&&p===y&&(m=p,b=c.find(h,[m,m]),w=c.convert(0,m),A=c.find(d,[m,m]));d=e&&a?[]:void 0;p=[];y=[];m=new s({values:d,index:p,ptr:y,size:[v,l],datatype:m});var v=e&&a?[]:void 0,E=e&&a?[]:void 0,F=[],N=[],C,G,D,I;for(G=0;G<l;G++){y[G]=p.length;var H=G+1;C=t[G];I=t[G+1];for(D=C;D<I;D++)C=f[D],p.push(C),F[C]=H,v&&(v[C]=e[D]);C=u[G];I=u[G+1];for(D=C;D<I;D++)if(C=
x[D],F[C]===H){if(v){var J=A(v[C],a[D]);b(J,w)?F[C]=null:v[C]=J}}else p.push(C),N[C]=H,E&&(E[C]=a[D]);if(v&&E)for(D=y[G];D<p.length;)C=p[D],F[C]===H?(d[D]=v[C],D++):N[C]===H?(d[D]=E[C],D++):p.splice(D,1)}y[l]=p.length;return m}}},function(m,e,a){var k=a(6).nearlyEqual;e.factory=function(a,d,b,c){return c("equalScalar",{"boolean, boolean":function(a,b){return a===b},"number, number":function(a,b){return a===b||k(a,b,d.epsilon)},"BigNumber, BigNumber":function(a,b){return a.eq(b)},"Fraction, Fraction":function(a,
b){return a.equals(b)},"Complex, Complex":function(a,b){return(a.re===b.re||k(a.re,b.re,d.epsilon))&&(a.im===b.im||k(a.im,b.im,d.epsilon))},"Unit, Unit":function(a,b){if(!a.equalBase(b))throw Error("Cannot compare units with different base");return a.value===b.value||k(a.value,b.value,d.epsilon)},"string, string":function(a,b){return a===b}})}},function(m,e){e.name="algorithm10";e.factory=function(a,e,f,d){var b=a.DenseMatrix;return function(a,e,f,r){var q=a._values,g=a._index,k=a._ptr,n=a._size,
t=a._datatype;if(!q)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");a=n[0];var n=n[1],l,p=f;"string"===typeof t&&(l=t,e=d.convert(e,l),p=d.find(f,[l,l]));f=[];l=new b({data:f,size:[a,n],datatype:l});for(var t=[],x=[],u=0;u<n;u++){for(var w=u+1,y=k[u+1],v=k[u];v<y;v++){var m=g[v];t[m]=q[v];x[m]=w}for(y=0;y<a;y++)0===u&&(f[y]=[]),f[y][u]=x[y]===w?r?p(e,t[y]):p(t[y],e):e}return l}}},function(m,e,a){a(14);var k=a(19);e.name="algorithm13";e.factory=function(a,d,b,c){var e=
a.DenseMatrix,s=function(a,b,c,d,e,f){var l=[];if(b===c.length-1)for(b=0;b<d;b++)l[b]=a(e[b],f[b]);else for(var h=0;h<d;h++)l[h]=s(a,b+1,c,c[b+1],e[h],f[h]);return l};return function(a,b,d){var f=a._data,n=a._size,t=a._datatype,l=b._data,p=b._size,x=b._datatype;a=[];if(n.length!==p.length)throw new k(n.length,p.length);for(var u=0;u<n.length;u++){if(n[u]!==p[u])throw new RangeError("Dimension mismatch. Matrix A ("+n+") must match Matrix B ("+p+")");a[u]=n[u]}var w,n=d;"string"===typeof t&&t===x&&
(w=t,c.convert(b,w),n=c.find(d,[w,w]));b=0<a.length?s(n,0,a,a[0],f,l):[];return new e({data:b,size:a,datatype:w})}}},function(m,e,a){var k=a(3).clone;e.name="algorithm14";e.factory=function(a,d,b,c){var e=a.DenseMatrix,s=function(a,b,c,d,e,f,l){var h=[];if(b===c.length-1)for(b=0;b<d;b++)h[b]=l?a(f,e[b]):a(e[b],f);else for(var k=0;k<d;k++)h[k]=s(a,b+1,c,c[b+1],e[k],f,l);return h};return function(a,b,d,f){var n=a._data,t=a._size;a=a._datatype;var l,p=d;"string"===typeof a&&(l=a,b=c.convert(b,l),p=c.find(d,
[l,l]));b=0<t.length?s(p,0,t,t[0],n,b,f):[];return new e({data:b,size:k(t),datatype:l})}}},function(m,e,a){var k=a(6).isInteger,f=a(15).size;e.name="pow";e.factory=function(d,b,c,e){function s(a,c){return k(c)||0<=a||b.predictable?Math.pow(a,c):r(new d.Complex(a,0),new d.Complex(c,0))}function r(a,b){return n(p(l(a),b))}function q(a,b){if(!k(b)||0>b)throw new TypeError("For A^b, b must be a positive integer (value is "+b+")");var c=f(a);if(2!=c.length)throw Error("For A^b, A must be 2 dimensional (A has "+
c.length+" dimensions)");if(c[0]!=c[1])throw Error("For A^b, A must be square (size is "+c[0]+"x"+c[1]+")");for(var c=t(c[0]).valueOf(),d=a;1<=b;)1==(b&1)&&(c=p(d,c)),b>>=1,d=p(d,d);return c}function g(a,b){return x(q(a.valueOf(),b))}var z=a(41),n=c(a(49)),t=c(a(50)),l=c(a(51)),p=c(a(53)),x=c(a(39));c=e("pow",{"number, number":s,"Complex, Complex":r,"BigNumber, BigNumber":function(a,c){return c.isInteger()||0<=a||b.predictable?a.pow(c):r(new d.Complex(a.toNumber(),0),new d.Complex(c.toNumber(),0))},
"Fraction, Fraction":function(a,c){if(1!==c.d){if(b.predictable)throw Error("Function pow does not support non-integer exponents for fractions.");return s(a.valueOf(),c.valueOf())}return a.pow(c)},"Array, number":q,"Array, BigNumber":function(a,b){return q(a,b.toNumber())},"Matrix, number":g,"Matrix, BigNumber":function(a,b){return g(a,b.toNumber())}});c.toTex="\\left(${args[0]}\\right)"+z.operators.pow+"{${args[1]}}";return c}},function(m,e,a){var k=a(25);e.name="exp";e.factory=function(a,d,b,c){var e=
c("exp",{number:Math.exp,Complex:function(b){var c=Math.exp(b.re);return new a.Complex(c*Math.cos(b.im),c*Math.sin(b.im))},BigNumber:function(a){return a.exp()},"Array | Matrix":function(a){return k(a,e)}});e.toTex="\\exp\\left(${args[0]}\\right)";return e}},function(m,e,a){var k=a(15),f=a(6).isInteger;e.name="eye";e.factory=function(d,b,c,e){function s(a,b){switch(a.length){case 0:return b?q(b):[];case 1:return r(a[0],a[0],b);case 2:return r(a[0],a[1],b);default:throw Error("Vector containing two values expected");
}}function r(a,b,c){var e=a&&!0===a.isBigNumber?d.BigNumber:b&&!0===b.isBigNumber?d.BigNumber:null;a&&!0===a.isBigNumber&&(a=a.toNumber());b&&!0===b.isBigNumber&&(b=b.toNumber());if(!f(a)||1>a)throw Error("Parameters in function eye must be positive integers");if(!f(b)||1>b)throw Error("Parameters in function eye must be positive integers");var l=e?new d.BigNumber(1):1,e=e?new e(0):0,h=[a,b];if(c)return d.Matrix.storage(c).diagonal(h,l,0,e);c=k.resize([],h,e);a=a<b?a:b;for(b=0;b<a;b++)c[b][b]=l;return c}
var q=c(a(39));c=e("eye",{"":function(){return"matrix"===b.matrix?q([]):[]},string:function(a){return q(a)},"number | BigNumber":function(a){return r(a,a,"matrix"===b.matrix?"default":void 0)},"number | BigNumber, string":function(a,b){return r(a,a,b)},"number | BigNumber, number | BigNumber":function(a,c){return r(a,c,"matrix"===b.matrix?"default":void 0)},"number | BigNumber, number | BigNumber, string":function(a,b,c){return r(a,b,c)},Array:function(a){return s(a)},"Array, string":function(a,b){return s(a,
b)},Matrix:function(a){return s(a.valueOf(),a.storage())},"Matrix, string":function(a,b){return s(a.valueOf(),b)}});c.toTex="\\mathrm{${name}}\\left(${args}\\right)";return c}},function(m,e,a){var k=a(25);e.name="log";e.factory=function(e,d,b,c){function h(a){return new e.Complex(Math.log(Math.sqrt(a.re*a.re+a.im*a.im)),Math.atan2(a.im,a.re))}var s=b(a(52)),r=c("log",{number:function(a){return 0<=a||d.predictable?Math.log(a):r(new e.Complex(a,0))},Complex:h,BigNumber:function(a){return!a.isNegative()||
d.predictable?a.ln():h(new e.Complex(a.toNumber(),0))},"Array | Matrix":function(a){return k(a,r)},"any, any":function(a,b){return s(r(a),r(b))}});r.toTex={1:"\\ln\\left(${args[0]}\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"};return r}},function(m,e){e.factory=function(a,e,f,d){return d("divide",{"number, number":function(a,c){return a/c},"Complex, Complex":function(b,c){var d=c.re*c.re+c.im*c.im;return 0!=d?new a.Complex((b.re*c.re+b.im*c.im)/d,(b.im*c.re-b.re*c.im)/d):new a.Complex(0!=
b.re?b.re/0:0,0!=b.im?b.im/0:0)},"BigNumber, BigNumber":function(a,c){return a.div(c)},"Fraction, Fraction":function(a,c){return a.div(c)},"Unit, number":function(a,c){var d=a.clone();d.value=(null===d.value?d._normalize(1):d.value)/c;return d}})}},function(m,e,a){var k=a(3).extend,f=a(15);e.name="multiply";e.factory=function(d,b,c,e){b=a(41);var s=c(a(39)),r=c(a(40)),q=c(a(54)),g=c(a(44)),m=c(a(55)),n=c(a(47)),t=d.DenseMatrix,l=d.SparseMatrix,p=e("multiply",k({"Array, Array":function(a,b){x(f.size(a),
f.size(b));var c=p(s(a),s(b));return c&&!0===c.isMatrix?c.valueOf():c},"Matrix, Matrix":function(a,b){var c=a.size(),d=b.size();x(c,d);if(1===c.length){if(1===d.length){var f=c[0];if(0===f)throw Error("Cannot multiply two empty vectors");var n=a._data,p=a._datatype,k=b._data,s=b._datatype,c=r,d=q;p&&s&&p===s&&"string"===typeof p&&(c=e.find(r,[p,p]),d=e.find(q,[p,p]));p=d(n[0],k[0]);for(s=1;s<f;s++)p=c(p,d(n[s],k[s]));return p}a:{switch(b.storage()){case "dense":var f=a._data,m=a._datatype,n=b._data,
z=b._datatype,c=a._size[0],d=b._size[1],p=r,s=q;m&&z&&m===z&&"string"===typeof m&&(k=m,p=e.find(r,[k,k]),s=e.find(q,[k,k]));m=[];for(z=0;z<d;z++){for(var I=s(f[0],n[0][z]),H=1;H<c;H++)I=p(I,s(f[H],n[H][z]));m[z]=I}f=1===d?m[0]:new t({data:m,size:[d],datatype:k});break a}throw Error("Not implemented");}return f}if(1===d.length){a:{switch(a.storage()){case "dense":f=a._data;d=a._size;m=a._datatype;k=b._data;z=b._datatype;c=d[0];d=d[1];p=r;s=q;m&&z&&m===z&&"string"===typeof m&&(n=m,p=e.find(r,[n,n]),
s=e.find(q,[n,n]));m=[];for(z=0;z<c;z++){for(var I=f[z],H=s(I[0],k[0]),J=1;J<d;J++)H=p(H,s(I[J],k[J]));m[z]=H}f=1===c?m[0]:new t({data:m,size:[c],datatype:n});break a;case "sparse":var p=a._values,s=a._index,m=a._ptr,K=a._datatype;if(!p)throw Error("Cannot multiply Pattern only Matrix times Dense Matrix");var z=b._data,L=b._datatype,n=a._size[0],I=b._size[0],k=[],c=[],d=[],H=r,J=q,da=g,S=0;K&&L&&K===L&&"string"===typeof K&&(f=K,H=e.find(r,[f,f]),J=e.find(q,[f,f]),da=e.find(g,[f,f]),S=e.convert(0,
f));for(var K=[],L=[],P=d[0]=0;P<I;P++){var T=z[P];if(!da(T,S))for(var la=m[P+1],U=m[P];U<la;U++){var V=s[U];L[V]?K[V]=H(K[V],J(T,p[U])):(L[V]=!0,c.push(V),K[V]=J(T,p[U]))}}p=c.length;for(s=0;s<p;s++)k[s]=K[c[s]];d[1]=c.length;f=1===n?1===k.length?k[0]:0:new l({values:k,index:c,ptr:d,size:[n,1],datatype:f});break a}f=void 0}return f}return u(a,b)},"Matrix, Array":function(a,b){return p(a,s(b))},"Array, Matrix":function(a,b){return p(s(a,b.storage()),b)},"Matrix, any":function(a,b){var c;switch(a.storage()){case "sparse":c=
m(a,b,q,!1);break;case "dense":c=n(a,b,q,!1)}return c},"any, Matrix":function(a,b){var c;switch(b.storage()){case "sparse":c=m(b,a,q,!0);break;case "dense":c=n(b,a,q,!0)}return c},"Array, any":function(a,b){return n(s(a),b,q,!1).valueOf()},"any, Array":function(a,b){return n(s(b),a,q,!0).valueOf()}},q.signatures)),x=function(a,b){switch(a.length){case 1:switch(b.length){case 1:if(a[0]!==b[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(a[0]!==
b[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+a[0]+") must match Matrix rows ("+b[0]+")");break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+b.length+" dimensions)");}break;case 2:switch(b.length){case 1:if(a[1]!==b[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+a[1]+") must match Vector length ("+b[0]+")");break;case 2:if(a[1]!==b[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+
a[1]+") must match Matrix B rows ("+b[0]+")");break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+b.length+" dimensions)");}break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+a.length+" dimensions)");}},u=function(a,b){switch(a.storage()){case "dense":switch(b.storage()){case "dense":var c;var d=a._data,f=a._size,n=a._datatype,p=b._data,k=b._datatype,s=f[0],u=f[1],x=b._size[1],m,z=r,J=q;n&&k&&n===k&&"string"===typeof n&&(m=
n,z=e.find(r,[m,m]),J=e.find(q,[m,m]));for(var K=[],L=0;L<s;L++){var da=d[L];K[L]=[];for(var S=0;S<x;S++){for(var P=J(da[0],p[0][S]),T=1;T<u;T++)P=z(P,J(da[T],p[T][S]));K[L][S]=P}}c=1===s&&1===x?K[0][0]:new t({data:K,size:[s,x],datatype:m});return c;case "sparse":var la;var U=a._data,V=a._size,ma=a._datatype,Ha=b._values,rb=b._index,Ta=b._ptr,sb=b._size,Ua=b._datatype;if(!Ha)throw Error("Cannot multiply Dense Matrix times Pattern only Matrix");var Ia=V[0],na=sb[1],Q,Va=r,Ja=q,Wa=g,Xa=0;ma&&Ua&&ma===
Ua&&"string"===typeof ma&&(Q=ma,Va=e.find(r,[Q,Q]),Ja=e.find(q,[Q,Q]),Wa=e.find(g,[Q,Q]),Xa=e.convert(0,Q));for(var oa=[],pa=[],Ka=[],tb=new l({values:oa,index:pa,ptr:Ka,size:[Ia,na],datatype:Q}),ea=0;ea<na;ea++){Ka[ea]=pa.length;var Ya=Ta[ea],Za=Ta[ea+1];if(Za>Ya)for(var La=0,Y=0;Y<Ia;Y++){for(var Ma=Y+1,fa,ga=Ya;ga<Za;ga++){var $a=rb[ga];La!==Ma?(fa=Ja(U[Y][$a],Ha[ga]),La=Ma):fa=Va(fa,Ja(U[Y][$a],Ha[ga]))}La!==Ma||Wa(fa,Xa)||(pa.push(Y),oa.push(fa))}}Ka[na]=pa.length;la=1===Ia&&1===na?1===oa.length?
oa[0]:0:tb;return la}break;case "sparse":switch(b.storage()){case "dense":var ab;var Na=a._values,ub=a._index,bb=a._ptr,qa=a._datatype;if(!Na)throw Error("Cannot multiply Pattern only Matrix times Dense Matrix");var vb=b._data,cb=b._datatype,db=a._size[0],wb=b._size[0],ra=b._size[1],R,eb=r,Oa=q,fb=g,gb=0;qa&&cb&&qa===cb&&"string"===typeof qa&&(R=qa,eb=e.find(r,[R,R]),Oa=e.find(q,[R,R]),fb=e.find(g,[R,R]),gb=e.convert(0,R));for(var sa=[],Z=[],ta=[],xb=new l({values:sa,index:Z,ptr:ta,size:[db,ra],datatype:R}),
ua=[],hb=[],$=0;$<ra;$++){ta[$]=Z.length;for(var ib=$+1,ha=0;ha<wb;ha++){var Pa=vb[ha][$];if(!fb(Pa,gb))for(var yb=bb[ha+1],ia=bb[ha];ia<yb;ia++){var aa=ub[ia];hb[aa]!==ib?(hb[aa]=ib,Z.push(aa),ua[aa]=Oa(Pa,Na[ia])):ua[aa]=eb(ua[aa],Oa(Pa,Na[ia]))}}for(var zb=Z.length,va=ta[$];va<zb;va++)sa[va]=ua[Z[va]]}ta[ra]=Z.length;ab=1===db&&1===ra?1===sa.length?sa[0]:0:xb;return ab;case "sparse":var jb;var Qa=a._values,kb=a._index,wa=a._ptr,xa=a._datatype,Ra=b._values,Ab=b._index,lb=b._ptr,mb=b._datatype,nb=
a._size[0],ya=b._size[1],ja=Qa&&Ra,ba,ob=r,Sa=q;xa&&mb&&xa===mb&&"string"===typeof xa&&(ba=xa,ob=e.find(r,[ba,ba]),Sa=e.find(q,[ba,ba]));for(var za=ja?[]:void 0,W=[],Aa=[],Bb=new l({values:za,index:W,ptr:Aa,size:[nb,ya],datatype:ba}),Ba=ja?[]:void 0,Ca=[],O,Da,Ea,ca,pb,qb,M,ka,X=0;X<ya;X++){Aa[X]=W.length;var Fa=X+1;pb=lb[X];qb=lb[X+1];for(ca=pb;ca<qb;ca++)if(ka=Ab[ca],ja)for(Da=wa[ka],Ea=wa[ka+1],O=Da;O<Ea;O++)M=kb[O],Ca[M]!==Fa?(Ca[M]=Fa,W.push(M),Ba[M]=Sa(Ra[ca],Qa[O])):Ba[M]=ob(Ba[M],Sa(Ra[ca],
Qa[O]));else for(Da=wa[ka],Ea=wa[ka+1],O=Da;O<Ea;O++)M=kb[O],Ca[M]!==Fa&&(Ca[M]=Fa,W.push(M));if(ja)for(var Cb=W.length,Ga=Aa[X];Ga<Cb;Ga++)za[Ga]=Ba[W[Ga]]}Aa[ya]=W.length;jb=1===nb&&1===ya&&ja?1===za.length?za[0]:0:Bb;return jb}}};p.toTex="\\left(${args[0]}"+b.operators.multiply+"${args[1]}\\right)";return p}},function(m,e){e.factory=function(a,e,f,d){return d("multiplyScalar",{"number, number":function(a,c){return a*c},"Complex, Complex":function(b,c){return new a.Complex(b.re*c.re-b.im*c.im,b.re*
c.im+b.im*c.re)},"BigNumber, BigNumber":function(a,c){return a.times(c)},"Fraction, Fraction":function(a,c){return a.mul(c)},"number, Unit":function(a,c){var d=c.clone();d.value=null===d.value?d._normalize(a):d.value*a;return d},"Unit, number":function(a,c){var d=a.clone();d.value=null===d.value?d._normalize(c):d.value*c;return d}})}},function(m,e,a){e.name="algorithm11";e.factory=function(e,f,d,b){var c=d(a(44)),h=e.SparseMatrix;return function(a,d,e,f){var k=a._values,n=a._index,t=a._ptr,l=a._size,
p=a._datatype;if(!k)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var m=l[0],l=l[1],u;a=c;var w=0,y=e;"string"===typeof p&&(u=p,a=b.find(c,[u,u]),w=b.convert(0,u),d=b.convert(d,u),y=b.find(e,[u,u]));e=[];var p=[],v=[];u=new h({values:e,index:p,ptr:v,size:[m,l],datatype:u});for(m=0;m<l;m++){v[m]=p.length;for(var B=t[m+1],A=t[m];A<B;A++){var E=n[A],F=f?y(d,k[A]):y(k[A],d);a(F,w)||(p.push(E),e.push(F))}}v[l]=p.length;return u}}},function(m,e,a){var k=a(6).nearlyEqual;
e.name="larger";e.factory=function(e,d,b,c){var h=b(a(39)),s=b(a(57)),r=b(a(58)),q=b(a(59)),g=b(a(46)),m=b(a(47));e=a(41);var n=c("larger",{"boolean, boolean":function(a,b){return a>b},"number, number":function(a,b){return a>b&&!k(a,b,d.epsilon)},"BigNumber, BigNumber":function(a,b){return a.gt(b)},"Fraction, Fraction":function(a,b){return 1===a.compare(b)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers");},"Unit, Unit":function(a,b){if(!a.equalBase(b))throw Error("Cannot compare units with different base");
return a.value>b.value&&!k(a.value,b.value,d.epsilon)},"string, string":function(a,b){return a>b},"Matrix, Matrix":function(a,b){var c;switch(a.storage()){case "sparse":switch(b.storage()){case "sparse":c=r(a,b,n);break;default:c=s(b,a,n,!0)}break;default:switch(b.storage()){case "sparse":c=s(a,b,n,!1);break;default:c=g(a,b,n)}}return c},"Array, Array":function(a,b){return n(h(a),h(b)).valueOf()},"Array, Matrix":function(a,b){return n(h(a),b)},"Matrix, Array":function(a,b){return n(a,h(b))},"Matrix, any":function(a,
b){var c;switch(a.storage()){case "sparse":c=q(a,b,n,!1);break;default:c=m(a,b,n,!1)}return c},"any, Matrix":function(a,b){var c;switch(b.storage()){case "sparse":c=q(b,a,n,!0);break;default:c=m(b,a,n,!0)}return c},"Array, any":function(a,b){return m(h(a),b,n,!1).valueOf()},"any, Array":function(a,b){return m(h(b),a,n,!0).valueOf()}});n.toTex="\\left(${args[0]}"+e.operators.larger+"${args[1]}\\right)";return n}},function(m,e,a){var k=a(19);e.name="algorithm03";e.factory=function(a,d,b,c){var e=a.DenseMatrix;
return function(a,b,d,f){var m=a._data,n=a._size,t=a._datatype;a=b._values;var l=b._index,p=b._ptr,x=b._size,u=b._datatype;if(n.length!==x.length)throw new k(n.length,x.length);if(n[0]!==x[0]||n[1]!==x[1])throw new RangeError("Dimension mismatch. Matrix A ("+n+") must match Matrix B ("+x+")");if(!a)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");b=n[0];var n=n[1],w,x=0,y=d;"string"===typeof t&&t===u&&(w=t,x=c.convert(0,w),y=c.find(d,[w,w]));d=[];for(t=0;t<b;t++)d[t]=
[];for(var t=[],u=[],v=0;v<n;v++){for(var B=v+1,A=p[v+1],E=p[v];E<A;E++){var F=l[E];t[F]=f?y(a[E],m[F][v]):y(m[F][v],a[E]);u[F]=B}for(A=0;A<b;A++)d[A][v]=u[A]===B?t[A]:f?y(x,m[A][v]):y(m[A][v],x)}return new e({data:d,size:[b,n],datatype:w})}}},function(m,e,a){var k=a(19);e.name="algorithm07";e.factory=function(a,d,b,c){var e=a.DenseMatrix,m=function(a,b,c,d,e){var f=a._values,l=a._index,p=a._ptr;a=p[b];for(b=p[b+1];a<b;a++)p=l[a],c[p]=e,d[p]=f[a]};return function(a,b,d){var f=a._size,n=a._datatype,
t=b._size,l=b._datatype;if(f.length!==t.length)throw new k(f.length,t.length);if(f[0]!==t[0]||f[1]!==t[1])throw new RangeError("Dimension mismatch. Matrix A ("+f+") must match Matrix B ("+t+")");var t=f[0],f=f[1],p,x=0,u=d;"string"===typeof n&&n===l&&(p=n,x=c.convert(0,p),u=c.find(d,[p,p]));n=[];for(d=0;d<t;d++)n[d]=[];var l=new e({data:n,size:[t,f],datatype:p}),w=[],y=[],v=[],B=[];for(p=0;p<f;p++){var A=p+1;m(a,p,v,w,A);m(b,p,B,y,A);for(d=0;d<t;d++)n[d][p]=u(v[d]===A?w[d]:x,B[d]===A?y[d]:x)}return l}}},
function(m,e){e.name="algorithm12";e.factory=function(a,e,f,d){var b=a.DenseMatrix;return function(a,e,f,k){var q=a._values,g=a._index,m=a._ptr,n=a._size,t=a._datatype;if(!q)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");a=n[0];var n=n[1],l,p=f;"string"===typeof t&&(l=t,e=d.convert(e,l),p=d.find(f,[l,l]));f=[];l=new b({data:f,size:[a,n],datatype:l});for(var t=[],x=[],u=0;u<n;u++){for(var w=u+1,y=m[u+1],v=m[u];v<y;v++){var B=g[v];t[B]=q[v];x[B]=w}for(y=0;y<a;y++)0===
u&&(f[y]=[]),f[y][u]=x[y]===w?k?p(e,t[y]):p(t[y],e):k?p(e,0):p(0,e)}return l}}},function(m,e,a){var k=a(6).nearlyEqual;e.name="smaller";e.factory=function(e,d,b,c){var h=b(a(39)),m=b(a(57)),r=b(a(58)),q=b(a(59)),g=b(a(46)),z=b(a(47));e=a(41);var n=c("smaller",{"boolean, boolean":function(a,b){return a<b},"number, number":function(a,b){return a<b&&!k(a,b,d.epsilon)},"BigNumber, BigNumber":function(a,b){return a.lt(b)},"Fraction, Fraction":function(a,b){return-1===a.compare(b)},"Complex, Complex":function(a,
b){throw new TypeError("No ordering relation is defined for complex numbers");},"Unit, Unit":function(a,b){if(!a.equalBase(b))throw Error("Cannot compare units with different base");return a.value<b.value&&!k(a.value,b.value,d.epsilon)},"string, string":function(a,b){return a<b},"Matrix, Matrix":function(a,b){var c;switch(a.storage()){case "sparse":switch(b.storage()){case "sparse":c=r(a,b,n);break;default:c=m(b,a,n,!0)}break;default:switch(b.storage()){case "sparse":c=m(a,b,n,!1);break;default:c=
g(a,b,n)}}return c},"Array, Array":function(a,b){return n(h(a),h(b)).valueOf()},"Array, Matrix":function(a,b){return n(h(a),b)},"Matrix, Array":function(a,b){return n(a,h(b))},"Matrix, any":function(a,b){var c;switch(a.storage()){case "sparse":c=q(a,b,n,!1);break;default:c=z(a,b,n,!1)}return c},"any, Matrix":function(a,b){var c;switch(b.storage()){case "sparse":c=q(b,a,n,!0);break;default:c=z(b,a,n,!0)}return c},"Array, any":function(a,b){return z(h(a),b,n,!1).valueOf()},"any, Array":function(a,b){return z(h(b),
a,n,!0).valueOf()}});n.toTex="\\left(${args[0]}"+e.operators.smaller+"${args[1]}\\right)";return n}},function(m,e,a){var k=a(3).clone,f=a(16).format;e.name="trace";e.factory=function(d,b,c,e){var m=c(a(39)),r=c(a(38)),q=e("trace",{Array:function(a){return q(m(a))},Matrix:function(a){var b;switch(a.storage()){case "dense":a:{var c=a._size;b=a._data;switch(c.length){case 1:if(1==c[0]){b=k(b[0]);break a}throw new RangeError("Matrix must be square (size: "+f(c)+")");case 2:var d=c[0];if(d===c[1]){for(a=
c=0;a<d;a++)c=r(c,b[a][a]);b=c;break a}throw new RangeError("Matrix must be square (size: "+f(c)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+f(c)+")");}}break;case "sparse":b=a._values;var d=a._index,c=a._ptr,e=a._size;a=e[1];if(e[0]===a){e=0;if(0<b.length)for(var h=0;h<a;h++)for(var q=c[h+1],u=c[h];u<q;u++){var m=d[u];if(m===h){e=r(e,b[u]);break}if(m>h)break}b=e}else throw new RangeError("Matrix must be square (size: "+f(e)+")");}return b},any:k});q.toTex="\\mathrm{tr}\\left(${args[0]}\\right)";
return q}},function(m,e,a){var k=a(3).clone,f=a(16).format;e.name="transpose";e.factory=function(d,b,c,e){b=a(41);var m=c(a(39)),r=d.DenseMatrix,q=d.SparseMatrix,g=e("transpose",{Array:function(a){return g(m(a)).valueOf()},Matrix:function(a){var b=a.size(),c;switch(b.length){case 1:c=a.clone();break;case 2:var d=b[0],e=b[1];if(0===e)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+f(b)+")");switch(a.storage()){case "dense":b=a._data;c=[];for(var g,h=0;h<e;h++){g=c[h]=[];
for(var m=0;m<d;m++)g[m]=k(b[m][h])}c=new r({data:c,size:[e,d],datatype:a._datatype});break;case "sparse":b=a._values;c=a._index;g=a._ptr;for(var h=b?[]:void 0,m=[],s=[],v=[],B=0;B<d;B++)v[B]=0;var A,B=0;for(A=c.length;B<A;B++)v[c[B]]++;for(A=B=0;A<d;A++)s.push(B),B+=v[A],v[A]=s[A];s.push(B);for(B=0;B<e;B++){A=g[B+1];for(var E=g[B];E<A;E++){var F=v[c[E]]++;m[F]=B;b&&(h[F]=k(b[E]))}}c=new q({values:h,index:m,ptr:s,size:[e,d],datatype:a._datatype})}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+
f(this._size)+")");}return c},any:function(a){return k(a)}});g.toTex="\\left(${args[0]}\\right)"+b.operators.transpose;return g}},function(m,e,a){var k=a(3).extend;e.name="divide";e.factory=function(e,d,b,c){var h=b(a(52)),m=b(a(53)),r=b(a(64)),q=b(a(39)),g=b(a(55)),z=b(a(47));e=c("divide",k({"Array | Matrix, Array | Matrix":function(a,b){return m(a,r(b))},"Matrix, any":function(a,b){var c;switch(a.storage()){case "sparse":c=g(a,b,h,!1);break;case "dense":c=z(a,b,h,!1)}return c},"Array, any":function(a,
b){return z(q(a),b,h,!1).valueOf()},"any, Array | Matrix":function(a,b){return m(a,r(b))}},h.signatures));e.toTex="\\frac{${args[0]}}{${args[1]}}";return e}},function(m,e,a){var k=a(14);e.name="inv";e.factory=function(e,d,b,c){function h(a,b,c){var d,e;if(1==b){b=a[0][0];if(0==b)throw Error("Cannot calculate inverse, determinant is zero");return[[r(1,b)]]}if(2==b){b=n(a);if(0==b)throw Error("Cannot calculate inverse, determinant is zero");return[[r(a[1][1],b),r(z(a[0][1]),b)],[r(z(a[1][0]),b),r(a[0][0],
b)]]}var f=a.concat();for(a=0;a<b;a++)f[a]=f[a].concat();for(var h=t(b).valueOf(),k=0;k<c;k++){for(a=k;a<b&&0==f[a][k];)a++;if(a==b||0==f[a][k])throw Error("Cannot calculate inverse, determinant is zero");a!=k&&(d=f[k],f[k]=f[a],f[a]=d,d=h[k],h[k]=h[a],h[a]=d);var m=f[k],s=h[k];for(a=0;a<b;a++){var F=f[a],N=h[a];if(a!=k){if(0!=F[k]){e=r(z(F[k]),m[k]);for(d=k;d<c;d++)F[d]=q(F[d],g(e,m[d]));for(d=0;d<c;d++)N[d]=q(N[d],g(e,s[d]))}}else{e=m[k];for(d=k;d<c;d++)F[d]=r(F[d],e);for(d=0;d<c;d++)N[d]=r(N[d],
e)}}}return h}var m=b(a(39)),r=b(a(52)),q=b(a(40)),g=b(a(53)),z=b(a(65)),n=b(a(66)),t=b(a(50));e=c("inv",{"Array | Matrix":function(a){var b=!0===a.isMatrix?a.size():k.array.size(a);switch(b.length){case 1:if(1==b[0])return!0===a.isMatrix?m([r(1,a.valueOf()[0])]):[r(1,a[0])];throw new RangeError("Matrix must be square (size: "+k.string.format(b)+")");case 2:var c=b[0],d=b[1];if(c==d)return!0===a.isMatrix?m(h(a.valueOf(),c,d),a.storage()):h(a,c,d);throw new RangeError("Matrix must be square (size: "+
k.string.format(b)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+k.string.format(b)+")");}},any:function(a){return r(1,a)}});e.toTex="\\left(${args[0]}\\right)^{-1}";return e}},function(m,e,a){var k=a(25);e.name="unaryMinus";e.factory=function(e,d,b,c){d=a(41);var h=c("unaryMinus",{number:function(a){return-a},Complex:function(a){return new e.Complex(-a.re,-a.im)},BigNumber:function(a){return a.neg()},Fraction:function(a){a=a.clone();a.s=-a.s;return a},Unit:function(a){var b=
a.clone();b.value=-a.value;return b},"Array | Matrix":function(a){return k(a,h,!0)}});h.toTex=d.operators.unaryMinus+"\\left(${args[0]}\\right)";return h}},function(m,e,a){m=a(14);var k=m.object,f=m.string;e.name="det";e.factory=function(d,b,c,e){var m=c(a(39)),r=c(a(38)),q=c(a(67)),g=c(a(53)),z=c(a(65));d=e("det",{any:function(a){return k.clone(a)},"Array | Matrix":function(a){var b;a&&!0===a.isMatrix?b=a.size():Array.isArray(a)?(a=m(a),b=a.size()):b=[];switch(b.length){case 0:return k.clone(a);
case 1:if(1==b[0])return k.clone(a.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+f.format(b)+")");case 2:var c=b[0];if(c==b[1]){a=a.clone().valueOf();if(1==c)c=k.clone(a[0][0]);else if(2==c)c=q(g(a[0][0],a[1][1]),g(a[1][0],a[0][1]));else{var d=a;for(b=0;b<c-1;b++){for(var e=void 0,h=void 0,w=Array(d.length),y=0,e=1;e<d.length;e++)y=r(y,d[e][e]);for(e=0;e<d.length;e++){w[e]=Array(d.length);w[e][e]=z(y);for(h=0;h<e;h++)w[e][h]=0;for(h=e+1;h<d.length;h++)w[e][h]=d[e][h];e+1<d.length&&
(y=q(y,d[e+1][e+1]))}d=g(w,a)}c=0==c%2?z(d[0][0]):d[0][0]}return c}throw new RangeError("Matrix must be square (size: "+f.format(b)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+f.format(b)+")");}}});d.toTex="\\det\\left(${args[0]}\\right)";return d}},function(m,e,a){var k=a(19);e.name="subtract";e.factory=function(e,d,b,c){d=a(41);var h=b(a(39)),m=b(a(40)),r=b(a(65)),q=b(a(42)),g=b(a(57)),z=b(a(68)),n=b(a(45)),t=b(a(46)),l=b(a(47)),p=c("subtract",{"number, number":function(a,
b){return a-b},"Complex, Complex":function(a,b){return new e.Complex(a.re-b.re,a.im-b.im)},"BigNumber, BigNumber":function(a,b){return a.minus(b)},"Fraction, Fraction":function(a,b){return a.sub(b)},"Unit, Unit":function(a,b){if(null==a.value)throw Error("Parameter x contains a unit with undefined value");if(null==b.value)throw Error("Parameter y contains a unit with undefined value");if(!a.equalBase(b))throw Error("Units do not match");var c=a.clone();c.value-=b.value;c.fixPrefix=!1;return c},"Matrix, Matrix":function(a,
b){var c=a.size(),d=b.size();if(c.length!==d.length)throw new k(c.length,d.length);switch(a.storage()){case "sparse":switch(b.storage()){case "sparse":c=z(a,b,p);break;default:c=g(b,a,p,!0)}break;default:switch(b.storage()){case "sparse":c=q(a,b,p,!1);break;default:c=t(a,b,p)}}return c},"Array, Array":function(a,b){return p(h(a),h(b)).valueOf()},"Array, Matrix":function(a,b){return p(h(a),b)},"Matrix, Array":function(a,b){return p(a,h(b))},"Matrix, any":function(a,b){var c;switch(a.storage()){case "sparse":c=
n(a,r(b),m);break;default:c=l(a,b,p)}return c},"any, Matrix":function(a,b){var c;switch(b.storage()){case "sparse":c=n(b,a,p,!0);break;default:c=l(b,a,p,!0)}return c},"Array, any":function(a,b){return l(h(a),b,p,!1).valueOf()},"any, Array":function(a,b){return l(h(b),a,p,!0).valueOf()}});p.toTex="\\left(${args[0]}"+d.operators.subtract+"${args[1]}\\right)";return p}},function(m,e,a){var k=a(19);e.name="algorithm05";e.factory=function(e,d,b,c){var h=b(a(44)),m=e.SparseMatrix;return function(a,b,d){var e=
a._values,f=a._index,t=a._ptr,l=a._size,p=a._datatype;a=b._values;var x=b._index,u=b._ptr,w=b._size,y=b._datatype;if(l.length!==w.length)throw new k(l.length,w.length);if(l[0]!==w[0]||l[1]!==w[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+w+")");var v=l[0],l=l[1],B;b=h;var w=0,A=d;"string"===typeof p&&p===y&&(B=p,b=c.find(h,[B,B]),w=c.convert(0,B),A=c.find(d,[B,B]));d=e&&a?[]:void 0;p=[];y=[];B=new m({values:d,index:p,ptr:y,size:[v,l],datatype:B});var v=d?[]:
void 0,E=d?[]:void 0,F=[],N=[],C,G,D,I;for(G=0;G<l;G++){y[G]=p.length;var H=G+1;D=t[G];for(I=t[G+1];D<I;D++)C=f[D],p.push(C),F[C]=H,v&&(v[C]=e[D]);D=u[G];for(I=u[G+1];D<I;D++)C=x[D],F[C]!==H&&p.push(C),N[C]=H,E&&(E[C]=a[D]);if(d)for(D=y[G];D<p.length;){C=p[D];I=F[C];var J=N[C];if(I===H||J===H)C=A(I===H?v[C]:w,J===H?E[C]:w),b(C,w)?p.splice(D,1):(d.push(C),D++)}}y[l]=p.length;return B}}},function(m,e,a){var k=a(15).size;e.name="cross";e.factory=function(e,d,b,c){function h(a,b){var c=k(a),d=k(b);if(1!=
c.length||1!=d.length||3!=c[0]||3!=d[0])throw new RangeError("Vectors with length 3 expected (Size A = ["+c.join(", ")+"], B = ["+d.join(", ")+"])");return[r(q(a[1],b[2]),q(a[2],b[1])),r(q(a[2],b[0]),q(a[0],b[2])),r(q(a[0],b[1]),q(a[1],b[0]))]}var m=b(a(39)),r=b(a(67)),q=b(a(53));e=c("cross",{"Matrix, Matrix":function(a,b){return m(h(a.toArray(),b.toArray()))},"Matrix, Array":function(a,b){return m(h(a.toArray(),b))},"Array, Matrix":function(a,b){return m(h(a,b.toArray()))},"Array, Array":h});e.toTex=
"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)";return e}},function(m,e,a){var k=a(15).size;e.name="dot";e.factory=function(e,d,b,c){function h(a,b){var c=k(a),d=k(b),e=c[0];if(1!==c.length||1!==d.length)throw new RangeError("Vector expected");if(c[0]!=d[0])throw new RangeError("Vectors must have equal length ("+c[0]+" != "+d[0]+")");if(0==e)throw new RangeError("Cannot calculate the dot product of empty vectors");for(d=c=0;d<e;d++)c=m(c,r(a[d],b[d]));return c}var m=b(a(38)),r=b(a(53));
e=c("dot",{"Matrix, Matrix":function(a,b){return h(a.toArray(),b.toArray())},"Matrix, Array":function(a,b){return h(a.toArray(),b)},"Array, Matrix":function(a,b){return h(a,b.toArray())},"Array, Array":h});e.toTex="\\left(${args[0]}\\cdot${args[1]}\\right)";return e}}]);
